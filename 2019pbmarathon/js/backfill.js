"use strict";var backfill_view=new Vue({el:"#app",data:{type:"",fblogin:!1,fbData:{fbtoken:"",fbId:"",fbName:"",fbPic:""},userid:"",mobile:"",inv_num:"",awarditem:"",name:"",address:"",IdcardFrontShow:"",IdcardBackShow:"",BankbookShow:"",CertificatePhotoShow:"",IdcardFront:null,IdcardBack:null,Bankbook:null,CertificatePhoto:null,agree:!1,start_date:"",mode_status:""},watch:{IdcardFront:function(){""==!this.IdcardFrontShow&&($("#frontpre p").css("display","none"),$("#frontpre img").css("opacity","1"))},IdcardBack:function(){""==!this.IdcardBackShow&&($("#backpre p").css("display","none"),$("#backpre img").css("opacity","1"))},Bankbook:function(){""==!this.BankbookShow&&($("#bankpre p").css("display","none"),$("#bankpre img").css("opacity","1"))},CertificatePhotoShow:function(){""==!this.CertificatePhotoShow&&($("#certificatepre p").css("display","none"),$("#certificatepre img").css("opacity","1"))}},methods:{readfront:function(){var t=this;document.getElementById("front").addEventListener("change",function(){var e=new FileReader;e.readAsDataURL(this.files[0]),e.onload=function(e){t.IdcardFront=e.target.result}},!1)},readpoto:function(e){var t=this,n=e.target.files.item(0),a=e.target.id;console.log(e),console.log(e.target.id),console.log(n);var o=new FileReader;o.addEventListener("load",function(e){"front"==a&&(t.IdcardFrontShow=e.target.result,t.IdcardFront=n);"back"==a&&(t.IdcardBackShow=e.target.result,t.IdcardBack=n);"bank"==a&&(t.BankbookShow=e.target.result,t.Bankbook=n);"certificate"==a&&(t.CertificatePhotoShow=e.target.result,t.CertificatePhoto=n)}),o.readAsDataURL(n)},getUserid:function(){var n=this;return new Promise(function(e,t){n.userid=findGetParameter("user"),e()})},postback:function(){var t=this;if("FB"==t.type){if(!t.loading){if(t.loading=!0,!t.name)return alert("請填入收件人"),void(t.loading=!1);if(!t.address)return alert("請填入地址"),void(t.loading=!1);if(!t.fbData.fbId)return alert("請先登入FB"),void(t.loading=!1);if(!t.agree)return alert("請勾選我已詳閱"),void(t.loading=!1);t.GameToken().then(function(){t.grecaptcha("backfill").then(function(){t.postRecipientinfo().then(function(e){e.success?alert("資料已送出，感謝您的參與！"):alert("您並無資格領取此獎項。"),window.location.href="./index.html",t.loading=!1})})})}}else if(!t.loading){if(t.loading=!0,!t.name)return alert("請填入收件人"),void(t.loading=!1);if(!t.address)return alert("請填入地址"),void(t.loading=!1);if(!t.CertificatePhoto)return alert("請上傳發票正本電子檔"),void(t.loading=!1);if(!t.agree)return alert("請勾選我已詳閱"),void(t.loading=!1);t.GameToken().then(function(){t.grecaptcha("backfill").then(function(){t.postRecipientinfo().then(function(e){e.success?(alert("資料已送出，感謝您的參與！"),window.location.href="./index.html"):alert(e.responseMessage),t.loading=!1})})})}},fbLogin:function(){var t=this;FB.login(function(e){"connected"===e.status&&(t.fbData.fbtoken=e.authResponse.accessToken,t.fbData.fbId=e.authResponse.userID,FB.api("/me","GET",{fields:"id,name,picture"},function(e){t.fbData.fbName=e.name,t.fbData.fbPic="http://graph.facebook.com/"+e.id+"/picture?width=140&height=140",t.fblogin=!0}))})}},mounted:function(){var e,t,n,a,o,i=this;$("body").loadpage("init",{async:!1}),i.getUserid().then(function(){i.GameToken().then(function(){i.getRecipientinfo()})}),window.fbAsyncInit=function(){FB.init({appId:"2114580888842549",status:!0,cookie:!0,xfbml:!1,version:"v4.0"})},e=document,t="script",n="facebook-jssdk",o=e.getElementsByTagName(t)[0],e.getElementById(n)||((a=e.createElement(t)).id=n,a.src="https://connect.facebook.net/en_US/sdk.js",o.parentNode.insertBefore(a,o))}});