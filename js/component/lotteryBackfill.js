"use strict";Vue.component("lottery-backfill",{template:"#lotteryBackfill",data:function(){return{type:"",mobile:"",userid:"",awardPaper:[{awardName:"現金 NT.99,999",path:"images/《能量不斷電終極大獎 現金99,999》中獎回覆函.doc"},{awardName:"Nintendo Switch",path:"images/《補充能量獎週週抽 Nintendo Switch》中獎回覆函.doc"},{awardName:"SONY PS4",path:"images/《百大鐵人排名獎 SONY PS4》中獎回覆函.doc"}],paper:null,fblogin:!1,fbData:{fbToken:"",fbId:"",fbName:"",fbPic:""},invNumber:"",awardItem:"",name:"",address:"",IdcardFront:null,IdcardBack:null,Bankbook:null,CertificatePhoto:null,agree:!1,imageShow:{IdcardFront:null,IdcardBack:null,Bankbook:null,CertificatePhoto:null}}},watch:{IdcardFront:function(){""==!this.IdcardFrontShow&&($("#frontpre p").css("display","none"),$("#frontpre img").css("opacity","1"))},IdcardBack:function(){""==!this.IdcardBackShow&&($("#backpre p").css("display","none"),$("#backpre img").css("opacity","1"))},Bankbook:function(){""==!this.BankbookShow&&($("#bankpre p").css("display","none"),$("#bankpre img").css("opacity","1"))},CertificatePhotoShow:function(){""==!this.CertificatePhotoShow&&($("#certificatepre p").css("display","none"),$("#certificatepre img").css("opacity","1"))}},methods:{readpoto:function(e){var a=this,t=e.target.files.item(0),n=e.target.id,i=new FileReader;i.addEventListener("load",function(e){"front"==n&&(a.imageShow.IdcardFront=e.target.result,a.IdcardFront=t);"back"==n&&(a.imageShow.IdcardBack=e.target.result,a.IdcardBack=t);"bank"==n&&(a.imageShow.Bankbook=e.target.result,a.Bankbook=t);"certificate"==n&&(a.imageShow.CertificatePhoto=e.target.result,a.CertificatePhoto=t)}),i.readAsDataURL(t)},postback:function(){var a=this;if(!a.loading){if(a.loading=!0,!a.name)return alert("請填入收件人"),void(a.loading=!1);if(!a.address)return alert("請填入地址"),void(a.loading=!1);if("FB"==a.type){if(!a.fbData.fbId)return alert("請先登入FB"),void(a.loading=!1)}else if("Invoice"==a.type&&!a.CertificatePhoto)return alert("請上傳發票正本電子檔"),void(a.loading=!1);if(!a.agree)return alert("請勾選我已詳閱"),void(a.loading=!1);a.getToken().then(function(){a.grecaptcha("backfill").then(function(){a.postRecipientinfo().then(function(e){e.success?alert("資料已送出，感謝您的參與！"):alert("您並無資格領取此獎項。"),window.location.href="./index.html",a.loading=!1})})})}},fbLogin:function(){var a=this;FB.login(function(e){"connected"===e.status&&(a.fbData.fbToken=e.authResponse.accessToken,a.fbData.fbId=e.authResponse.userID,FB.api("/me","GET",{fields:"id,name,picture"},function(e){a.fbData.fbName=e.name,a.fbData.fbPic="http://graph.facebook.com/"+e.id+"/picture?width=140&height=140",a.fblogin=!0}))})},getRecipientinfo:function(){var a=this;return $.ajax({url:"".concat(friendo_url,"comebest/recipientinfo/").concat(a.userid),headers:{Authorization:"Bearer "+a.mainToken},method:"GET"}).done(function(e){e.success?(a.mobile=e.data.mobile,a.invNumber=e.data.referenceInfo,a.awardItem=e.data.awardName,a.type=e.data.referenceType):(alert("資料已回填或無法查獲此獎項"),window.location.href="./index.html")})},checkPaper:function(){var a=this;a.awardPaper.forEach(function(e){if(a.awardItem==e.awardName)return a.paper=e})}},mounted:function(){var e=this;$("body").loadpage("init",{async:!1}),e.userid=findGetParameter("user"),e.getToken().then(function(){e.getRecipientinfo().then(function(){e.checkPaper()})})}});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudC9sb3R0ZXJ5QmFja2ZpbGwuanMiXSwibmFtZXMiOlsiVnVlIiwiY29tcG9uZW50IiwidGVtcGxhdGUiLCJ0eXBlIiwibW9iaWxlIiwidXNlcmlkIiwiYXdhcmRQYXBlciIsImF3YXJkTmFtZSIsInBhdGgiLCJwYXBlciIsImZibG9naW4iLCJmYlRva2VuIiwiZmJJZCIsImZiTmFtZSIsImZiUGljIiwiaW52TnVtYmVyIiwiYXdhcmRJdGVtIiwiYWRkcmVzcyIsIklkY2FyZEZyb250IiwiQmFua2Jvb2siLCJJZGNhcmRCYWNrIiwiYWdyZWUiLCJDZXJ0aWZpY2F0ZVBob3RvIiwid2F0Y2giLCJ0aGlzIiwiSWRjYXJkRnJvbnRTaG93IiwiJCIsImNzcyIsIklkY2FyZEJhY2tTaG93IiwiQ2VydGlmaWNhdGVQaG90b1Nob3ciLCJCYW5rYm9va1Nob3ciLCJyZWFkcG90byIsImUiLCJ2bSIsIml0ZW0iLCJpZCIsInRhcmdldCIsInJlYWRlciIsIkZpbGVSZWFkZXIiLCJhZGRFdmVudExpc3RlbmVyIiwiaW1hZ2VTaG93IiwicmVzdWx0IiwiZmlsZSIsImltZ0xvYWQiLCJyZWFkQXNEYXRhVVJMIiwicG9zdGJhY2siLCJsb2FkaW5nIiwiYWxlcnQiLCJmYkRhdGEiLCJnZXRUb2tlbiIsInRoZW4iLCJncmVjYXB0Y2hhIiwicG9zdFJlY2lwaWVudGluZm8iLCJyZXMiLCJzdWNjZXNzIiwid2luZG93IiwibG9jYXRpb24iLCJocmVmIiwiZmJMb2dpbiIsIkZCIiwibG9naW4iLCJzdGF0dXMiLCJhdXRoUmVzcG9uc2UiLCJhY2Nlc3NUb2tlbiIsInVzZXJJRCIsImFwaSIsImZpZWxkcyIsImFwaXJlcyIsIm5hbWUiLCJnZXRSZWNpcGllbnRpbmZvIiwiYWpheCIsInVybCIsImNvbmNhdCIsImZyaWVuZG9fdXJsIiwiaGVhZGVycyIsIkF1dGhvcml6YXRpb24iLCJtYWluVG9rZW4iLCJkYXRhIiwicmVmZXJlbmNlSW5mbyIsInJlZmVyZW5jZVR5cGUiLCJjaGVja1BhcGVyIiwiZm9yRWFjaCIsIm1vdW50ZWQiLCJtZXRob2QiLCJkb25lIiwibG9hZHBhZ2UiLCJhc3luYyJdLCJtYXBwaW5ncyI6ImFBQUFBLElBQUlDLFVBQVUsbUJBQW9CLENBQzlCQyxTQUFVLG1CQURWRCxLQUFBQSxXQUNBQyxNQUFVLENBQ0pDLEtBQUEsR0FDS0MsT0FBQSxHQUNHQyxPQURILEdBQ09DLFdBQUEsQ0FEUCxDQUFBQyxVQUFBLGVBS0NDLEtBQUEsd0NBQ0ksQ0FDUUQsVUFBQSxrQkFDVEMsS0FBQSw4Q0FDQyxDQUNRRCxVQUFBLFdBQ1RDLEtBQUEsdUNBWEpDLE1BQUEsS0FnQkVDLFNBaEJGLEVBaUJIQSxPQWpCRyxDQWtCS0MsUUFBQSxHQUNHQyxLQURILEdBQUFDLE9BQUEsR0FHSUMsTUFISixJQWxCTEMsVUFBQSxHQXdCSEEsVUF4QkcsR0F5QkhDLEtBQVcsR0FDTEMsUUExQkgsR0EyQkhBLFlBM0JHLEtBNEJIQyxXQTVCRyxLQTRCZ0JDLFNBQUEsS0FDbkJDLGlCQTdCRyxLQTZCZUMsT0FBQSxFQUNsQkYsVUE5QkcsQ0E4QmFELFlBQUEsS0FDaEJJLFdBL0JHLEtBK0JxQkgsU0FBQSxLQUNqQkcsaUJBaENKLFFBb0NDQyxNQUFBLENBQ0FMLFlBQUEsV0FyQ1IsS0FpQ2VNLEtBakNmQyxrQkFIMEJDLEVBQUEsZUFBQUMsSUFBQSxVQUFBLFFBNEN2QkQsRUFBQSxpQkFBQUMsSUFBQSxVQUFBLE9BUUhQLFdBQVksV0FKSixLQURJSyxLQUNGRyxpQkFDQUYsRUFBQSxjQUFxQkMsSUFBQSxVQUF2QixRQUNIRCxFQUFBLGdCQUFBQyxJQUFBLFVBQUEsT0FHRFIsU0FBUyxXQUNxQixLQU1yQkssS0FOREksZUFDRkYsRUFBQSxjQUFrQkMsSUFBQSxVQUFwQixRQUNFRCxFQUFBLGdCQUFvQkMsSUFBQSxVQUF0QixPQUdSUixxQkFBVSxXQVMwQixLQVJoQ0ssS0FRUUssdUJBUEFDLEVBQUFBLHFCQUFvQkgsSUFBQSxVQUFBLFFBQ3RCRCxFQUFBLHVCQUE2QkMsSUFBL0IsVUFB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Z0QsUUFIQyxXQU1WQyxJQUFBQSxFQUFRM0QsS0FOTEUsRUFRSjBELFFBQUtDLFNBQUEsT0FBZSxDQUNmQyxPQUFLaEMsSUFFTEMsRUFBQUEsT0FBT0MsaUJBQWdCLFFBRXZCdkIsRUFBQUEsV0FBWW9CLEtBQUl3QixXQUNkNUMsRUFBQ2xCLG1CQUFxQitELEtBQUFBLFdBQ3JCOUQsRUFBQUEiLCJmaWxlIjoiY29tcG9uZW50L2xvdHRlcnlCYWNrZmlsbC5qcyIsInNvdXJjZXNDb250ZW50IjpbIlZ1ZS5jb21wb25lbnQoJ2xvdHRlcnktYmFja2ZpbGwnLCB7XHJcbiAgICB0ZW1wbGF0ZTogXCIjbG90dGVyeUJhY2tmaWxsXCIsXHJcbiAgICBkYXRhOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgdHlwZTogXCJcIiwgLy8gSW52b2ljZVwiIG9yIEZCXHJcbiAgICAgICAgICAgIG1vYmlsZTogXCJcIixcclxuICAgICAgICAgICAgdXNlcmlkOiBcIlwiLFxyXG4gICAgICAgICAgICBhd2FyZFBhcGVyOiBbXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgXCJhd2FyZE5hbWVcIjogXCLnj77ph5EgTlQuOTksOTk5XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgXCJwYXRoXCI6IFwiaW1hZ2VzL+OAiuiDvemHj+S4jeaWt+mbu+e1gualteWkp+eNjiDnj77ph5E5OSw5OTnjgIvkuK3njY7lm57opoblh70uZG9jXCJcclxuICAgICAgICAgICAgICAgIH0sIHtcclxuICAgICAgICAgICAgICAgICAgICBcImF3YXJkTmFtZVwiOiBcIk5pbnRlbmRvIFN3aXRjaFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIFwicGF0aFwiOiBcImltYWdlcy/jgIroo5zlhYXog73ph4/njY7pgLHpgLHmir0gTmludGVuZG8gU3dpdGNo44CL5Lit542O5Zue6KaG5Ye9LmRvY1wiXHJcbiAgICAgICAgICAgICAgICB9LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgXCJhd2FyZE5hbWVcIjogXCJTT05ZIFBTNFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIFwicGF0aFwiOiBcImltYWdlcy/jgIrnmb7lpKfpkLXkurrmjpLlkI3njY4gU09OWSBQUzTjgIvkuK3njY7lm57opoblh70uZG9jXCJcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICAgIHBhcGVyOiBudWxsLFxyXG4gICAgICAgICAgICBmYmxvZ2luOiBmYWxzZSxcclxuICAgICAgICAgICAgZmJEYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBmYlRva2VuOiBcIlwiLFxyXG4gICAgICAgICAgICAgICAgZmJJZDogXCJcIixcclxuICAgICAgICAgICAgICAgIGZiTmFtZTogXCJcIixcclxuICAgICAgICAgICAgICAgIGZiUGljOiBcIlwiLFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBpbnZOdW1iZXI6IFwiXCIsXHJcbiAgICAgICAgICAgIGF3YXJkSXRlbTogXCJcIixcclxuICAgICAgICAgICAgbmFtZTogXCJcIixcclxuICAgICAgICAgICAgYWRkcmVzczogXCJcIixcclxuICAgICAgICAgICAgSWRjYXJkRnJvbnQ6IG51bGwsIC8v5q2j6Z2iXHJcbiAgICAgICAgICAgIElkY2FyZEJhY2s6IG51bGwsIC8v5Y+N6Z2iXHJcbiAgICAgICAgICAgIEJhbmtib29rOiBudWxsLCAvL+WtmOaRulxyXG4gICAgICAgICAgICBDZXJ0aWZpY2F0ZVBob3RvOiBudWxsLCAvL+eZvOelqFxyXG4gICAgICAgICAgICBhZ3JlZTogZmFsc2UsXHJcbiAgICAgICAgICAgIGltYWdlU2hvdzoge1xyXG4gICAgICAgICAgICAgICAgXCJJZGNhcmRGcm9udFwiOiBudWxsLFxyXG4gICAgICAgICAgICAgICAgXCJJZGNhcmRCYWNrXCI6IG51bGwsXHJcbiAgICAgICAgICAgICAgICBcIkJhbmtib29rXCI6IG51bGwsXHJcbiAgICAgICAgICAgICAgICBcIkNlcnRpZmljYXRlUGhvdG9cIjogbnVsbFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICB3YXRjaDoge1xyXG4gICAgICAgIElkY2FyZEZyb250OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgICAgIGlmICghdm0uSWRjYXJkRnJvbnRTaG93ID09IFwiXCIpIHtcclxuICAgICAgICAgICAgICAgICQoXCIjZnJvbnRwcmUgcFwiKS5jc3MoXCJkaXNwbGF5XCIsIFwibm9uZVwiKTtcclxuICAgICAgICAgICAgICAgICQoXCIjZnJvbnRwcmUgaW1nXCIpLmNzcyhcIm9wYWNpdHlcIiwgXCIxXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBJZGNhcmRCYWNrOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgICAgIGlmICghdm0uSWRjYXJkQmFja1Nob3cgPT0gXCJcIikge1xyXG4gICAgICAgICAgICAgICAgJChcIiNiYWNrcHJlIHBcIikuY3NzKFwiZGlzcGxheVwiLCBcIm5vbmVcIik7XHJcbiAgICAgICAgICAgICAgICAkKFwiI2JhY2twcmUgaW1nXCIpLmNzcyhcIm9wYWNpdHlcIiwgXCIxXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBCYW5rYm9vazogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgICAgICBpZiAoIXZtLkJhbmtib29rU2hvdyA9PSBcIlwiKSB7XHJcbiAgICAgICAgICAgICAgICAkKFwiI2JhbmtwcmUgcFwiKS5jc3MoXCJkaXNwbGF5XCIsIFwibm9uZVwiKTtcclxuICAgICAgICAgICAgICAgICQoXCIjYmFua3ByZSBpbWdcIikuY3NzKFwib3BhY2l0eVwiLCBcIjFcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIENlcnRpZmljYXRlUGhvdG9TaG93OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgICAgIGlmICghdm0uQ2VydGlmaWNhdGVQaG90b1Nob3cgPT0gXCJcIikge1xyXG4gICAgICAgICAgICAgICAgJChcIiNjZXJ0aWZpY2F0ZXByZSBwXCIpLmNzcyhcImRpc3BsYXlcIiwgXCJub25lXCIpO1xyXG4gICAgICAgICAgICAgICAgJChcIiNjZXJ0aWZpY2F0ZXByZSBpbWdcIikuY3NzKFwib3BhY2l0eVwiLCBcIjFcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgfSxcclxuICAgIG1ldGhvZHM6IHtcclxuICAgICAgICByZWFkcG90byhlKSB7IC8vaW5wdXQgZmlsZSBvbmNoYW5nZSBldmVudFxyXG4gICAgICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgICAgICB2YXIgZmlsZSA9IGUudGFyZ2V0LmZpbGVzLml0ZW0oMCk7XHJcbiAgICAgICAgICAgIHZhciBpZCA9IGUudGFyZ2V0LmlkO1xyXG4gICAgICAgICAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcclxuICAgICAgICAgICAgcmVhZGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBpbWdMb2FkKTtcclxuICAgICAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoZmlsZSk7XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBpbWdMb2FkKGUpIHtcclxuICAgICAgICAgICAgICAgIGlmIChpZCA9PSBcImZyb250XCIpIHtcclxuICAgICAgICAgICAgICAgICAgICB2bS5pbWFnZVNob3cuSWRjYXJkRnJvbnQgPSBlLnRhcmdldC5yZXN1bHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0uSWRjYXJkRnJvbnQgPSBmaWxlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGlkID09IFwiYmFja1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0uaW1hZ2VTaG93LklkY2FyZEJhY2sgPSBlLnRhcmdldC5yZXN1bHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0uSWRjYXJkQmFjayA9IGZpbGU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoaWQgPT0gXCJiYW5rXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICB2bS5pbWFnZVNob3cuQmFua2Jvb2sgPSBlLnRhcmdldC5yZXN1bHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0uQmFua2Jvb2sgPSBmaWxlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGlkID09IFwiY2VydGlmaWNhdGVcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHZtLmltYWdlU2hvdy5DZXJ0aWZpY2F0ZVBob3RvID0gZS50YXJnZXQucmVzdWx0O1xyXG4gICAgICAgICAgICAgICAgICAgIHZtLkNlcnRpZmljYXRlUGhvdG8gPSBmaWxlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBwb3N0YmFjaygpIHtcclxuICAgICAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICAgICAgaWYgKCF2bS5sb2FkaW5nKSB7XHJcbiAgICAgICAgICAgICAgICB2bS5sb2FkaW5nID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGlmICghdm0ubmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwi6KuL5aGr5YWl5pS25Lu25Lq6XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZtLmxvYWRpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICBpZiAoIXZtLmFkZHJlc3MpIHtcclxuICAgICAgICAgICAgICAgICAgICBhbGVydChcIuiri+Whq+WFpeWcsOWdgFwiKTtcclxuICAgICAgICAgICAgICAgICAgICB2bS5sb2FkaW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgaWYgKHZtLnR5cGUgPT0gXCJGQlwiKSB7IFxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghdm0uZmJEYXRhLmZiSWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoXCLoq4vlhYjnmbvlhaVGQlwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdm0ubG9hZGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh2bS50eXBlID09IFwiSW52b2ljZVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF2bS5DZXJ0aWZpY2F0ZVBob3RvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwi6KuL5LiK5YKz55m856Wo5q2j5pys6Zu75a2Q5qqUXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2bS5sb2FkaW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYoIXZtLklkY2FyZEZyb250KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIGFsZXJ0KFwi6KuL5LiK5YKz6Lqr5Lu96K2J5q2j6Z2i6Zu75a2Q5qqUXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICB2bS5sb2FkaW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIH07XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYoIXZtLklkY2FyZEJhY2spIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgYWxlcnQoXCLoq4vkuIrlgrPouqvku73orYnlj43pnaLpm7vlrZDmqpRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIHZtLmxvYWRpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gfTtcclxuICAgICAgICAgICAgICAgICAgICAvLyBpZighdm0uQmFua2Jvb2spIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgYWxlcnQoXCLoq4vkuIrlgrPlrZjmkbrpm7vlrZDmqpRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIHZtLmxvYWRpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gfTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICghdm0uYWdyZWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBhbGVydChcIuiri+WLvumBuOaIkeW3suips+mWsVwiKTtcclxuICAgICAgICAgICAgICAgICAgICB2bS5sb2FkaW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgdm0uZ2V0VG9rZW4oKS50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICB2bS5ncmVjYXB0Y2hhKFwiYmFja2ZpbGxcIikudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZtLnBvc3RSZWNpcGllbnRpbmZvKCkudGhlbihmdW5jdGlvbiAocmVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJlcy5zdWNjZXNzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoXCLmgqjkuKbnhKHos4fmoLzpoJjlj5bmraTnjY7poIXjgIJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBcIi4vaW5kZXguaHRtbFwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZtLmxvYWRpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoXCLos4fmlpnlt7LpgIHlh7rvvIzmhJ/orJ3mgqjnmoTlj4PoiIfvvIFcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBcIi4vaW5kZXguaHRtbFwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZtLmxvYWRpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIGZiTG9naW4oKSB7XHJcbiAgICAgICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgICAgIEZCLmxvZ2luKGZ1bmN0aW9uIChyZXMpIHtcclxuICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocmVzKTtcclxuICAgICAgICAgICAgICAgIGlmIChyZXMuc3RhdHVzID09PSAnY29ubmVjdGVkJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZtLmZiRGF0YS5mYlRva2VuID0gcmVzLmF1dGhSZXNwb25zZS5hY2Nlc3NUb2tlbjtcclxuICAgICAgICAgICAgICAgICAgICB2bS5mYkRhdGEuZmJJZCA9IHJlcy5hdXRoUmVzcG9uc2UudXNlcklEO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyDlj5blvpdmYuWAi+S6uuizh+aWmVxyXG4gICAgICAgICAgICAgICAgICAgIEZCLmFwaSgnL21lJywgJ0dFVCcsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZmllbGRzXCI6IFwiaWQsbmFtZSxwaWN0dXJlXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGFwaXJlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coYXBpcmVzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZtLmZiRGF0YS5mYk5hbWUgPSBhcGlyZXMubmFtZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHZtLmZiRGF0YS5mYlBpYyA9IGFwaXJlcy5waWN0dXJlLmRhdGEudXJsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdm0uZmJEYXRhLmZiUGljID0gJ2h0dHA6Ly9ncmFwaC5mYWNlYm9vay5jb20vJyArIGFwaXJlcy5pZCArICcvcGljdHVyZT93aWR0aD0xNDAmaGVpZ2h0PTE0MCc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2bS5mYmxvZ2luID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSxcclxuICAgICAgICBnZXRSZWNpcGllbnRpbmZvOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgICAgIHJldHVybiAkLmFqYXgoe1xyXG4gICAgICAgICAgICAgICAgLy8gdXJsOiBgJHtmcmllbmRvX3VybH1HZXRQcm9qZWN0SW5mb2AsXHJcbiAgICAgICAgICAgICAgICB1cmw6IGAke2ZyaWVuZG9fdXJsfWNvbWViZXN0L3JlY2lwaWVudGluZm8vJHt2bS51c2VyaWR9YCxcclxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICAgICAgICAgICBcIkF1dGhvcml6YXRpb25cIjogXCJCZWFyZXIgXCIgKyB2bS5tYWluVG9rZW4sXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgbWV0aG9kOiBcIkdFVFwiLFxyXG4gICAgICAgICAgICAgICAgLy8gZGF0YVR5cGU6IFwianNvblwiLFxyXG4gICAgICAgICAgICB9KS5kb25lKGZ1bmN0aW9uIChyZXMpIHtcclxuICAgICAgICAgICAgICAgIGlmICghcmVzLnN1Y2Nlc3MpIHtcclxuICAgICAgICAgICAgICAgICAgICBhbGVydChcIuizh+aWmeW3suWbnuWhq+aIlueEoeazleafpeeNsuatpOeNjumghVwiKTtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IFwiLi9pbmRleC5odG1sXCI7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHZtLm1vYmlsZSA9IHJlcy5kYXRhLm1vYmlsZTtcclxuICAgICAgICAgICAgICAgICAgICB2bS5pbnZOdW1iZXIgPSByZXMuZGF0YS5yZWZlcmVuY2VJbmZvO1xyXG4gICAgICAgICAgICAgICAgICAgIHZtLmF3YXJkSXRlbSA9IHJlcy5kYXRhLmF3YXJkTmFtZTtcclxuICAgICAgICAgICAgICAgICAgICB2bS50eXBlID0gcmVzLmRhdGEucmVmZXJlbmNlVHlwZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9LFxyXG4gICAgICAgIGNoZWNrUGFwZXI6IGZ1bmN0aW9uICgpIHsgXHJcbiAgICAgICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgICAgIHZtLmF3YXJkUGFwZXIuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkgeyBcclxuICAgICAgICAgICAgICAgIGlmICh2bS5hd2FyZEl0ZW0gPT0gaXRlbS5hd2FyZE5hbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdm0ucGFwZXIgPSBpdGVtO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBtb3VudGVkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICAvLyB2bS5yZWFkcGljKCk7XHJcbiAgICAgICAgJChcImJvZHlcIikubG9hZHBhZ2UoXCJpbml0XCIsIHtcclxuICAgICAgICAgICAgYXN5bmM6IGZhbHNlXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdm0udXNlcmlkID0gZmluZEdldFBhcmFtZXRlcigndXNlcicpO1xyXG5cclxuICAgICAgICB2bS5nZXRUb2tlbigpLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2bS5nZXRSZWNpcGllbnRpbmZvKCkudGhlbihmdW5jdGlvbiAoKSB7IFxyXG4gICAgICAgICAgICAgICAgdm0uY2hlY2tQYXBlcigpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgLy8gJChcImJvZHlcIikubG9hZHBhZ2UoXCJjbG9zZVwiKTtcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG59KTsiXX0=
