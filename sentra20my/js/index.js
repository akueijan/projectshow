"use strict";var index_view=new Vue({el:"#app",data:{step:"kv",reason:"",lineuserid:"",linePic:"",lineName:"",userScore:0,userMin:0,userSec:0,slick:!0,resultWord:"",yearArr:[],monthArr:[],dayArr:[],userName:"",userPhone:"",userbir:{year:"",month:"",day:""},isMember:!1,haveAward:!1,isPlay:!1,isNissan:!1,isAgree:!1,ticketCount:0,awardName:"",awardCode:"",awardShortUrl:"",isGame:!1,lotteryPlay:!1,isGet:!1},methods:{saveLeader:function(){var e=this,a={line_user_id:e.lineId,second:e.userScore};return $.ajax({url:"".concat(e.apiUrl,"api/lottery/").concat(e.entId,"/leader"),headers:{Authorization:"Bearer "+e.mainToken},method:"POST",data:a,dataType:"json"}).done(function(e){})},getData:function(){var a=this,e={line_user_id:a.lineId};return $.ajax({url:"".concat(a.apiUrl,"api/lottery/").concat(a.entId,"/profile"),headers:{Authorization:"Bearer "+a.mainToken},method:"GET",data:e,dataType:"json"}).done(function(e){a.userName=e.data.name,a.userPhone=e.data.phone,a.isMember=e.data.isMember,a.isPlay=e.data.isPlay,a.isNissan=e.data.isNissan,""!=!e.data.birthday&&null!=!e.data.birthday||(a.userbir.year=parseInt(e.data.birthday.slice(0,4)),a.userbir.month=parseInt(e.data.birthday.slice(5,7)),a.userbir.day=parseInt(e.data.birthday.slice(8,10))),a.awardName=e.data.awardName,a.awardCode=e.data.awardCode,a.awardShortUrl=e.data.awardShortUrl})},saveData:function(){var e=this;e.userbir.month<10&&(e.userbir.month="0"+e.userbir.month),e.userbir.day<10&&(e.userbir.day="0"+e.userbir.day),e.isNissan?e.isNissan=1:e.isNissan=0;var a={line_user_id:e.lineId,name:e.userName,phone:e.userPhone,birthday:e.userbir.year+"-"+e.userbir.month+"-"+e.userbir.day,is_nissan:e.isNissan};return $.ajax({url:"".concat(e.apiUrl,"api/lottery/").concat(e.entId,"/profile"),headers:{Authorization:"Bearer "+e.mainToken},method:"POST",data:a,dataType:"json"}).done(function(e){})},getLottery:function(){var e=this,a={line_user_id:e.lineId};return $.ajax({url:"".concat(e.apiUrl,"api/lottery/").concat(e.entId,"/drawing"),headers:{Authorization:"Bearer "+e.mainToken},method:"POST",data:a,dataType:"json"}).done(function(e){})},saveShare:function(){var e=this,a={line_user_id:e.lineId};return $.ajax({url:"".concat(e.apiUrl,"api/lottery/").concat(e.entId,"/share"),headers:{Authorization:"Bearer "+e.mainToken},method:"POST",data:a,dataType:"json"}).done(function(e){})},togame:function(){var e=this;e.isGame=!0,e.step="start",e.popup=!0,e.popPage="readme",setTimeout(function(){(new carGame).init()},100)},toGrades:function(){var e=this;e.showArr(),e.step="result",e.reason=""},toProfile:function(){this.step="done",this.isGame=!1},toLottery:function(){this.step="lottery"},rePlay:function(){var e=this;e.isGame=!0,e.step="start",e.popup=!0,e.popPage="readme",e.slick=!0,document.querySelector(".popup").style="background: url(./images/popup_bg.png) center top repeat",setTimeout(function(){(new carGame).init()},100)},playturn:function(){var e,a=this,t=new TimelineMax({delay:.3,onComplete:function(){a.isGet&&(a.step="useraward",a.isGame=!1)}});a.lotteryPlay=!0,t.fromTo(".lotterybg",1.5,{rotation:0},{rotation:1800});var r=Math.floor(2*Math.random());0==r&&(e=Math.floor(70*Math.random())+100,a.lotteryPlay=!1,--a.ticketCount,t.to(".lotterybg",.6,{rotation:1800+e},"-=0.3")),1==r&&(e=Math.floor(50*Math.random())+30,a.lotteryPlay=!1,a.isGet=!0,--a.ticketCount,t.to(".lotterybg",.6,{rotation:1800+e},"-=0.3"))},birthdayArr:function(){for(var e=this,a=2020;1919<a;a--)e.yearArr.push(a);for(var t=1;t<13;t++)e.monthArr.push(t);for(var r=1;r<32;r++)e.dayArr.push(r)},kvAni:function(){var e=new TimelineMax({delay:.6});e.from(".kv h2",.6,{opacity:0}),e.from(".kv .togame",.6,{opacity:0},"-=0.6"),e.from(".kvcar",.6,{y:-60,x:300,opacity:0}),e.from(".kv .kvft",.6,{opacity:0},"-=0.3")},checkData:function(){var e=this;""!=e.userName?""!=e.userPhone&&e.userPhone.match(/^09[0-9]{8}$/)?""!=e.userbir.year&&null!=e.userbir.year?""!=e.userbir.month&&null!=e.userbir.month?""!=e.userbir.day&&null!=e.userbir.day?e.isAgree?(e.popup=!0,e.popPage="loading",e.saveData().then(function(){e.step="done",e.popup=!1,e.popPage=""})):alert("請勾選我已詳閱並同意活動辦法"):alert("請選擇出生日"):alert("請選擇出生月"):alert("請選擇出生年"):alert("請輸入正確格式手機號碼"):alert("請填寫姓名")},lotteryShare:function(){this.eventShare(),this.ticketCount+=1},awardreadme:function(){this.popup=!0,this.popPage="awardreadme"}},mounted:function(){1e3<window.innerWidth&&(this.step="pcindex",this.isGame=!0),this.birthdayArr(),this.kvAni()}});