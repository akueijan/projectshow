"use strict";var production="false"===$("#appjs").data("mode"),friendo_url=$("#appjs").data("site"),device=deviceCheck();Vue.config.devtools=!production,Vue.config.debug=!production,Vue.config.silent=production;var md=new MobileDetect(window.navigator.userAgent),tag=document.createElement("script");function findGetParameter(o){var t=null,n=[];return location.search.substr(1).split("&").forEach(function(e){(n=e.split("="))[0]===o&&(t=decodeURIComponent(n[1]))}),t}function checkCookie(o){var t=null,n=[];return document.cookie.split(";").forEach(function(e){" "==e.charAt(0)&&(e=e.substring(1)),(n=e.split("="))[0]===o&&(t=n[1])}),t}function deviceCheck(){var e={},o=new MobileDetect(window.navigator.userAgent);return o.match(/android/i)?(e.os="android",e.version=o.version("android")):o.match(/(iphone|ipad|ipod);?/i)?(e.os="ios",e.version=o.version("iOS")):(e.os="pc",e.version=o.version("Chrome")),e}$(function(){console.log("v1.0"),console.log(device),$(".nav").menu()}),Vue.mixin({data:function(){return{status:"",start_date:"2100/08/09 12:09:10",error_msg:"",popuptop:"",navHeight:"",rewardShake:!0,lineHref:"",gToken:"",reCaptcha:"",popup:!1,popEvent:"",popPage:"",resultLoad:!1,loading:!1,oops:1}},computed:{openCome:function(){return!("Testing"==this.mode||start_date<=0)}},watch:{error_msg:function(e){$("body").toggleClass("_freeze")}},methods:{gaEvant:function(e){dataLayer.push({event:e}),console.log("ga:",e)},server_busy:function(){var e=this;e.error_msg="系統忙碌中，請稍後在試!",e.loading=!1,e.error_cou=6},setCookie:function(e,o,t){var n=new Date;n.setTime(n.getTime()+1e3*t);var r="expires="+n.toUTCString();document.cookie=e+"="+o+";"+r+";"},logger:function(e,o,t){if(production){_LTracker.push({level:["ERROR","DEBUG","WARNING","INFO","ALL"][e],content:JSON.stringify(o),path:window.location.href,tag:t||null,device:device,timestamp:Date.now()})}},errorDone:function(){this.error_msg=""},checkOnline:function(){navigator.onLine||alert("Internet 連線已斷開，請確認您的網路狀態。")},getToken:function(){var o=this;return $.ajax({url:"".concat(friendo_url,"auth/login?projectId=73"),headers:{WebToken:"Vn2lAsVSmwjXJn8UqZZ-Ag=="},method:"GET",dataType:"json"}).done(function(e){o.gToken=e.token})},getstatus:function(){return $.ajax({url:"".concat(friendo_url,"MineShine/getstatus"),headers:{Authorization:"Bearer "+this.gToken},method:"GET",done:function(e){}})},scrollTo:function(e){var o=this;o.room=null,o.allPopupClose(),$("html,body").animate({scrollTop:$(e).offset().top-o.navHeight},500)},popupOpen:function(){var e=this;e.popuptop&&0!==e.popuptop||(e.popuptop=Math.max(window.pageYOffset,document.documentElement.scrollTop,document.body.scrollTop)),$("body").addClass("_freeze")},eventOpen:function(){this.popup=!0,this.popEvent="event",$("body").addClass("_freeze")},popupClose:function(){var e=this;$("body").removeClass("_freeze"),e.popEvent="",e.popPage="",e.popup=!1,e.resultLoad=!1},afterEnter:function(){this.popupOpen()},grecaptcha:function(o){function e(e){return o.apply(this,arguments)}return e.toString=function(){return o.toString()},e}(function(t){var n=this;return new Promise(function(o,e){grecaptcha.execute("6LeGFsQUAAAAAKbckoPXNx-db-ZoTjVBOBnRuFq9",{action:t}).then(function(e){n.reCaptcha=e,o()},function(){alert("Google驗證失敗，請再次嘗試\n如無法排除此問題，建議重新整理此頁面"),e()})})}),getIe:function(){var o,e;function t(e){return 0<=o.indexOf(e)}"ie"==(o=window.navigator.userAgent,e="ActiveXObject"in window,t("MSIE")||e?"ie":t("Firefox")&&!e?"Firefox":t("Chrome")&&!e?"Chrome":t("Opera")&&!e?"Opera":t("Safari")&&!e?"Safari":void 0)&&alert("目前瀏覽器為舊版 IE，建議使用Chrome瀏覽器，獲得最佳遊戲體驗！")}},components:{comingsoon:comingsoon},mounted:function(){}}),Vue.component("comingsoon",{template:"#comingsoon",props:["StartDate","mode"],data:function(){return{comingsoon:!1,comPage:"",start_date:"",mode_status:"",date:{total:0,days:0,hours:0,minutes:0,seconds:0}}},mounted:function(){function i(e,o){return(e=""+e).length>=o?e:i("0"+e,o)}var a=this;a.getToken().then(function(){a.getstatus().then(function(e){})});setInterval(function(){var e=Date.parse(new Date(a.StartDate))-Date.parse(new Date),o=Math.floor(e/1e3%60),t=Math.floor(e/1e3/60%60),n=Math.floor(e/36e5%24),r=Math.floor(e/864e5);a.date={total:e,days:i(r,2),hours:i(n,2),minutes:i(t,2),seconds:i(o,2)}},1e3)}});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJwcm9kdWN0aW9uIiwiJCIsImRhdGEiLCJkZXZpY2UiLCJkZXZpY2VDaGVjayIsIlZ1ZSIsImNvbmZpZyIsImRlYnVnIiwic2lsZW50IiwibWQiLCJNb2JpbGVEZXRlY3QiLCJ3aW5kb3ciLCJuYXZpZ2F0b3IiLCJ1c2VyQWdlbnQiLCJjb25zb2xlIiwibG9nIiwidG1wIiwicGFyYW1ldGVyTmFtZSIsInJlc3VsdCIsIml0ZW0iLCJsb2NhdGlvbiIsInNlYXJjaCIsInN1YnN0ciIsImNoZWNrQ29va2llIiwic3BsaXQiLCJkb2N1bWVudCIsImNvb2tpZSIsImZvckVhY2giLCJjaGFyQXQiLCJzdWJzdHJpbmciLCJzdGFydF9kYXRlIiwidmVyc2lvbiIsIm9zIiwibWF0Y2giLCJmaW5kR2V0UGFyYW1ldGVyIiwibWVudSIsIm1peGluIiwicG9wdXB0b3AiLCJuYXZIZWlnaHQiLCJyZXdhcmRTaGFrZSIsImxpbmVIcmVmIiwiZXJyb3JfbXNnIiwicG9wRXZlbnQiLCJwb3BQYWdlIiwicmVzdWx0TG9hZCIsImxvYWRpbmciLCJyZUNhcHRjaGEiLCJwb3B1cCIsIm1vZGUiLCJvb3BzIiwib3BlbkNvbWUiLCJ0b2dnbGVDbGFzcyIsInRoaXMiLCJnYUV2YW50IiwiZGF0YUxheWVyIiwicHVzaCIsInZhbCIsImd0bURhdGEiLCJtZXRob2RzIiwic2VydmVyX2J1c3kiLCJldmVudCIsInZtIiwic2V0Q29va2llIiwic2V0VGltZSIsImVycm9yX2NvdSIsImNuYW1lIiwiY3ZhbHVlIiwidGltZSIsImQiLCJEYXRlIiwiZ2V0VGltZSIsInRhZyIsImNvbnRlbnQiLCJ0b1VUQ1N0cmluZyIsImV4cGlyZXMiLCJsb2dnZXIiLCJsZXZlbCIsIl9MVHJhY2tlciIsInN0cmluZ2lmeSIsIkpTT04iLCJwYXRoIiwibm93IiwiaHJlZiIsInRpbWVzdGFtcCIsImNoZWNrT25saW5lIiwib25MaW5lIiwiYWxlcnQiLCJ1cmwiLCJoZWFkZXJzIiwiYWpheCIsImNvbmNhdCIsImZyaWVuZG9fdXJsIiwiV2ViVG9rZW4iLCJnVG9rZW4iLCJ0b2tlbiIsImRhdGFUeXBlIiwiZG9uZSIsInJlcyIsIkF1dGhvcml6YXRpb24iLCJtZXRob2QiLCJzY3JvbGxUb3AiLCJvZmZzZXQiLCJyb29tIiwicG9wdXBPcGVuIiwiYWxsUG9wdXBDbG9zZSIsImFuaW1hdGUiLCJlIiwidG9wIiwiYWRkQ2xhc3MiLCJNYXRoIiwibWF4IiwicGFnZVlPZmZzZXQiLCJkb2N1bWVudEVsZW1lbnQiLCJib2R5IiwiZXZlbnRPcGVuIiwicG9wdXBDbG9zZSIsInJlbW92ZUNsYXNzIiwiYWZ0ZXJFbnRlciIsImdyZWNhcHRjaGEiLCJfZ3JlY2FwdGNoYSIsIl94IiwiYXBwbHkiLCJhcmd1bWVudHMiLCJ0b1N0cmluZyIsInBhZ2UiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsImV4ZWN1dGUiLCJhY3Rpb24iLCJ0aGVuIiwiZXhwbG9yZXIiLCJpZTExIiwiY29tcGFyZSIsInMiLCJpbmRleE9mIiwiY29tcG9uZW50cyIsImNvbWluZ3Nvb24iLCJtb3VudGVkIiwiY29tcG9uZW50IiwidGVtcGxhdGUiLCJwcm9wcyIsImdldEV4cGxvcmVyIiwiY29tUGFnZSIsIm1vZGVfc3RhdHVzIiwiZGF0ZSIsImRheXMiLCJob3VycyIsIm1pbnV0ZXMiLCJzZWNvbmRzIiwicGFkTGVmdCIsInN0ciIsImxlbiIsImxlbmd0aCIsImdldFRva2VuIiwiZ2V0c3RhdHVzIiwic2V0SW50ZXJ2YWwiLCJ0IiwicGFyc2UiLCJTdGFydERhdGUiLCJmbG9vciIsInRvdGFsIl0sIm1hcHBpbmdzIjoiYUFBQSxJQUNJQSxXQUEwQyxVQUE3QkMsRUFBRSxVQUFVQyxLQUFLLFFBQTlCRixZQUFjQyxFQUFDLFVBQVVDLEtBQUssUUFHNUJDLE9BQVNDLGNBR2ZDLElBQUlDLE9BQU9DLFVBQVNQLFdBQ3BCSyxJQUFJQyxPQUFPRSxPQUFTUixXQUVwQkssSUFBSUksT0FBS0QsT0FBSUUsV0FJYlQsSUFBRVEs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QUt5RixNQUFNLElBQUl6RixNQWhCcERvRixFQUFVRCxLQUFLUSxNQUFBSCxFQUFBLElBQUEsSUFDWk4sRUFBUDFDLEtBQUFtRCxNQUFBSCxFQUFBLElBQUEsR0FBQSxJQUNHVixFQUFBdEMsS0FBQW1ELE1BQUFILEVBQUEsS0FBQSxJQUNJUCxFQUFRekMsS0FBQW1ELE1BQVdSLEVBQUFBLE9BQzdCM0YsRUFBQW9GLEtBQUEsQ0FOTGdCLE1BQUFKLEVBeUJRWCxLQUFRSSxFQUFRSixFQUFNLEdBakJyQkMsTUFDVEcsRUFBQUgsRUFBQSxHQUNBQyxRQUFBRSxFQUFBRixFQUFBLEdBQ0FDLFFBQUFDLEVBQUFELEVBQUEsS0FRUUEiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3RcclxuICAgIHByb2R1Y3Rpb24gPSAkKFwiI2FwcGpzXCIpLmRhdGEoXCJtb2RlXCIpID09PSBcImZhbHNlXCIsXHJcbiAgICBmcmllbmRvX3VybCA9ICQoXCIjYXBwanNcIikuZGF0YShcInNpdGVcIik7XHJcblxyXG5jb25zdCBkZXZpY2UgPSBkZXZpY2VDaGVjaygpO1xyXG5cclxuVnVlLmNvbmZpZy5kZXZ0b29scyA9ICFwcm9kdWN0aW9uO1xyXG5WdWUuY29uZmlnLmRlYnVnID0gIXByb2R1Y3Rpb247XHJcblZ1ZS5jb25maWcuc2lsZW50ID0gcHJvZHVjdGlvbjtcclxuXHJcbnZhciBtZCA9IG5ldyBNb2JpbGVEZXRlY3Qod2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQpO1xyXG5cclxudmFyIHRhZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpO1xyXG5cclxuJChmdW5jdGlvbiAoKSB7XHJcbiAgICBjb25zb2xlLmxvZyhcInYxLjBcIik7XHJcbiAgICBjb25zb2xlLmxvZyhkZXZpY2UpO1xyXG4gICAgJChcIi5uYXZcIikubWVudSgpO1xyXG59KTsgXHJcblxyXG5cclxuZnVuY3Rpb24gZmluZEdldFBhcmFtZXRlcihwYXJhbWV0ZXJOYW1lKSB7XHJcbiAgICB2YXIgcmVzdWx0ID0gbnVsbCxcclxuICAgICAgICB0bXAgPSBbXTtcclxuICAgIGxvY2F0aW9uLnNlYXJjaFxyXG4gICAgICAgIC5zdWJzdHIoMSlcclxuICAgICAgICAuc3BsaXQoXCImXCIpXHJcbiAgICAgICAgLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcclxuICAgICAgICAgICAgdG1wID0gaXRlbS5zcGxpdChcIj1cIik7XHJcbiAgICAgICAgICAgIGlmICh0bXBbMF0gPT09IHBhcmFtZXRlck5hbWUpXHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBkZWNvZGVVUklDb21wb25lbnQodG1wWzFdKTtcclxuICAgICAgICB9KTtcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNoZWNrQ29va2llKHBhcmFtZXRlck5hbWUpIHtcclxuICAgIHZhciByZXN1bHQgPSBudWxsLFxyXG4gICAgICAgIHRtcCA9IFtdO1xyXG4gICAgdmFyIGNvb2tpZSA9IGRvY3VtZW50LmNvb2tpZTtcclxuICAgIGNvb2tpZS5zcGxpdChcIjtcIilcclxuICAgICAgICAuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgICAgICAgICBpZiAoaXRlbS5jaGFyQXQoMCkgPT0gXCIgXCIpIHtcclxuICAgICAgICAgICAgICAgIGl0ZW0gPSBpdGVtLnN1YnN0cmluZygxKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0bXAgPSBpdGVtLnNwbGl0KFwiPVwiKTtcclxuICAgICAgICAgICAgaWYgKHRtcFswXSA9PT0gcGFyYW1ldGVyTmFtZSlcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRtcFsxXTtcclxuICAgICAgICB9KVxyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG5mdW5jdGlvbiBkZXZpY2VDaGVjaygpIHtcclxuICAgIHZhciBkZXZpY2UgPSB7fTtcclxuICAgIHZhciBtZCA9IG5ldyBNb2JpbGVEZXRlY3Qod2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQpO1xyXG4gICAgaWYgKG1kLm1hdGNoKC9hbmRyb2lkL2kpKSB7XHJcbiAgICAgICAgZGV2aWNlLm9zID0gXCJhbmRyb2lkXCI7XHJcbiAgICAgICAgZGV2aWNlLnZlcnNpb24gPSBtZC52ZXJzaW9uKFwiYW5kcm9pZFwiKTtcclxuICAgIH0gZWxzZSBpZiAobWQubWF0Y2goLyhpcGhvbmV8aXBhZHxpcG9kKTs/L2kpKSB7XHJcbiAgICAgICAgZGV2aWNlLm9zID0gXCJpb3NcIjtcclxuICAgICAgICBkZXZpY2UudmVyc2lvbiA9IG1kLnZlcnNpb24oXCJpT1NcIik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGRldmljZS5vcyA9IFwicGNcIjtcclxuICAgICAgICBkZXZpY2UudmVyc2lvbiA9IG1kLnZlcnNpb24oXCJDaHJvbWVcIik7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZGV2aWNlO1xyXG59XHJcblZ1ZS5taXhpbih7XHJcbiAgICBkYXRhOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3RhdHVzOiBcIlwiLFxyXG4gICAgICAgICAgICBzdGFydF9kYXRlOiBcIjIxMDAvMDgvMDkgMTI6MDk6MTBcIixcclxuICAgICAgICAgICAgZXJyb3JfbXNnOiBcIlwiLFxyXG4gICAgICAgICAgICAvLyBtb2RlOiBwcm9kdWN0aW9uID8gXCJTdGFydGVkXCIgOiBcIlRlc3RpbmdcIixcclxuICAgICAgICAgICAgcG9wdXB0b3A6IFwiXCIsXHJcbiAgICAgICAgICAgIG5hdkhlaWdodDogXCJcIixcclxuICAgICAgICAgICAgcmV3YXJkU2hha2U6IHRydWUsXHJcbiAgICAgICAgICAgIGxpbmVIcmVmOiAnJyxcclxuICAgICAgICAgICAgZ1Rva2VuOiBcIlwiLFxyXG4gICAgICAgICAgICByZUNhcHRjaGE6IFwiXCIsXHJcbiAgICAgICAgICAgIHBvcHVwOiBmYWxzZSxcclxuICAgICAgICAgICAgcG9wRXZlbnQ6IFwiXCIsXHJcbiAgICAgICAgICAgIHBvcFBhZ2U6IFwiXCIsXHJcbiAgICAgICAgICAgIHJlc3VsdExvYWQ6IGZhbHNlLFxyXG4gICAgICAgICAgICBsb2FkaW5nOiBmYWxzZSxcclxuICAgICAgICAgICAgb29wczogMVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBjb21wdXRlZDoge1xyXG4gICAgICAgIG9wZW5Db21lOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAhKHRoaXMubW9kZSA9PSBcIlRlc3RpbmdcIiB8fCBzdGFydF9kYXRlIDw9IDApO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICB3YXRjaDoge1xyXG4gICAgICAgIGVycm9yX21zZzogZnVuY3Rpb24gKHZhbCkge1xyXG4gICAgICAgICAgICAkKCdib2R5JykudG9nZ2xlQ2xhc3MoJ19mcmVlemUnKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgbWV0aG9kczoge1xyXG4gICAgICAgIGdhRXZhbnQ6IGZ1bmN0aW9uIChndG1EYXRhKSB7XHJcbiAgICAgICAgICAgIGRhdGFMYXllci5wdXNoKHsnZXZlbnQnOiBndG1EYXRhfSk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZ2E6XCIsIGd0bURhdGEpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2VydmVyX2J1c3k6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICAgICAgdm0uZXJyb3JfbXNnID0gXCLns7vntbHlv5nnoozkuK3vvIzoq4vnqI3lvozlnKjoqaYhXCI7XHJcbiAgICAgICAgICAgIHZtLmxvYWRpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgdm0uZXJyb3JfY291ID0gNjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNldENvb2tpZTogZnVuY3Rpb24gKGNuYW1lLCBjdmFsdWUsIHRpbWUpIHtcclxuICAgICAgICAgICAgdmFyIGQgPSBuZXcgRGF0ZSgpO1xyXG4gICAgICAgICAgICBkLnNldFRpbWUoZC5nZXRUaW1lKCkgKyAodGltZSAqIDEwMDApKTtcclxuICAgICAgICAgICAgdmFyIGV4cGlyZXMgPSBcImV4cGlyZXM9XCIgKyBkLnRvVVRDU3RyaW5nKCk7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LmNvb2tpZSA9IGNuYW1lICsgXCI9XCIgKyBjdmFsdWUgKyBcIjtcIiArIGV4cGlyZXMgKyBcIjtcIjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGxvZ2dlcjogZnVuY3Rpb24gKGxldmVsLCBjb250ZW50LCB0YWcpIHtcclxuICAgICAgICAgICAgaWYgKHByb2R1Y3Rpb24pIHtcclxuICAgICAgICAgICAgICAgIC8vIGxldmVsIDogWydFUlJPUicgPT4gMCwgREVCVUcnID0+IDEsICdXQVJOSU5HJyA9PiAyLCAnSU5GTycgPT4gMywgJ0FMTCcgPT4gNF1cclxuICAgICAgICAgICAgICAgIHZhciBsZXZlbF9pbmZvID0gWydFUlJPUicsICdERUJVRycsICdXQVJOSU5HJywgJ0lORk8nLCAnQUxMJ107XHJcbiAgICAgICAgICAgICAgICBfTFRyYWNrZXIucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgJ2xldmVsJzogbGV2ZWxfaW5mb1tsZXZlbF0sXHJcbiAgICAgICAgICAgICAgICAgICAgJ2NvbnRlbnQnOiBKU09OLnN0cmluZ2lmeShjb250ZW50KSxcclxuICAgICAgICAgICAgICAgICAgICAncGF0aCc6IHdpbmRvdy5sb2NhdGlvbi5ocmVmLFxyXG4gICAgICAgICAgICAgICAgICAgICd0YWcnOiB0YWcgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAnZGV2aWNlJzogZGV2aWNlLFxyXG4gICAgICAgICAgICAgICAgICAgICd0aW1lc3RhbXAnOiBEYXRlLm5vdygpXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZXJyb3JEb25lOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZXJyb3JfbXNnID0gXCJcIjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGNoZWNrT25saW5lOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICghbmF2aWdhdG9yLm9uTGluZSkge1xyXG4gICAgICAgICAgICAgICAgYWxlcnQoXCJJbnRlcm5ldCDpgKPnt5rlt7LmlrfplovvvIzoq4vnorroqo3mgqjnmoTntrLot6/ni4DmhYvjgIJcIik7XHJcbiAgICAgICAgICAgICAgICAvLyB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIGdldFRva2VuOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICAgICAgcmV0dXJuICQuYWpheCh7XHJcbiAgICAgICAgICAgICAgICAvLyB1cmw6IFwiaHR0cHM6Ly9jYXJyZWZvdXIyMDE5Y255LmF6dXJld2Vic2l0ZXMubmV0L2FwaS9hdXRoL2xvZ2luP3Byb2plY3RJZD02MVwiLFxyXG4gICAgICAgICAgICAgICAgdXJsOiBgJHtmcmllbmRvX3VybH1hdXRoL2xvZ2luP3Byb2plY3RJZD03M2AsXHJcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgXCJXZWJUb2tlblwiOiBcIlZuMmxBc1ZTbXdqWEpuOFVxWlotQWc9PVwiXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgbWV0aG9kOiBcIkdFVFwiLFxyXG4gICAgICAgICAgICAgICAgZGF0YVR5cGU6IFwianNvblwiXHJcbiAgICAgICAgICAgIH0pLmRvbmUoZnVuY3Rpb24ocmVzKXtcclxuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwidG9rZW5cIixyZXMpO1xyXG4gICAgICAgICAgICAgICAgdm0uZ1Rva2VuID0gcmVzLnRva2VuO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGdldHN0YXR1czogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgICAgICByZXR1cm4gJC5hamF4KHtcclxuICAgICAgICAgICAgICAgIHVybDogYCR7ZnJpZW5kb191cmx9TWluZVNoaW5lL2dldHN0YXR1c2AsXHJcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgXCJBdXRob3JpemF0aW9uXCI6IFwiQmVhcmVyIFwiKyB2bS5nVG9rZW4sXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgbWV0aG9kOiBcIkdFVFwiLFxyXG4gICAgICAgICAgICAgICAgZG9uZTogZnVuY3Rpb24gKHJlcykge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwiZ2V0c3RhdHVzXCIscmVzKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyB2bS5zdGFydF9kYXRlID0gcmVzLmRhdGEuU3RhcnREYXRlVGltZTtcclxuICAgICAgICAgICAgICAgICAgICAvLyB2bS5tb2RlID0gcmVzLmRhdGEuZ2FtZV9zdGF0dXM7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSxcclxuICAgICAgICBzY3JvbGxUbzogZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICAgICAgdm0ucm9vbSA9IG51bGw7XHJcbiAgICAgICAgICAgIHZtLmFsbFBvcHVwQ2xvc2UoKTtcclxuICAgICAgICAgICAgJChcImh0bWwsYm9keVwiKS5hbmltYXRlKHtcclxuICAgICAgICAgICAgICAgIHNjcm9sbFRvcDogJChlKS5vZmZzZXQoKS50b3AgLSB2bS5uYXZIZWlnaHRcclxuICAgICAgICAgICAgfSwgNTAwKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHBvcHVwT3BlbjogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgICAgICBpZiAoIXZtLnBvcHVwdG9wIHx8IHZtLnBvcHVwdG9wID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICB2bS5wb3B1cHRvcCA9IE1hdGgubWF4KHdpbmRvdy5wYWdlWU9mZnNldCwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcCwgZG9jdW1lbnQuYm9keS5zY3JvbGxUb3ApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICQoJ2JvZHknKS5hZGRDbGFzcygnX2ZyZWV6ZScpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZXZlbnRPcGVuOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICAgICAgdm0ucG9wdXAgPSB0cnVlO1xyXG4gICAgICAgICAgICB2bS5wb3BFdmVudCA9IFwiZXZlbnRcIjtcclxuICAgICAgICAgICAgJCgnYm9keScpLmFkZENsYXNzKCdfZnJlZXplJyk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBwb3B1cENsb3NlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgICAgICQoJ2JvZHknKS5yZW1vdmVDbGFzcygnX2ZyZWV6ZScpO1xyXG4gICAgICAgICAgICB2bS5wb3BFdmVudCA9IFwiXCI7XHJcbiAgICAgICAgICAgIHZtLnBvcFBhZ2UgPSBcIlwiO1xyXG4gICAgICAgICAgICB2bS5wb3B1cCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAvLyB2bS5mYWNlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHZtLnJlc3VsdExvYWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgLy8gJCgnaHRtbCwgYm9keScpLnNjcm9sbFRvcCh2bS5wb3B1cHRvcCk7XHJcbiAgICAgICAgICAgIC8vIHZtLnBvcHVwdG9wID0gMDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGFmdGVyRW50ZXI6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICAgICAgdm0ucG9wdXBPcGVuKCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBncmVjYXB0Y2hhOiBmdW5jdGlvbihwYWdlKSB7XHJcbiAgICAgICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdpbicpXHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICBncmVjYXB0Y2hhLmV4ZWN1dGUoJzZMZUdGc1FVQUFBQUFLYmNrb1BYTngtZGItWm9UalZCT0JuUnVGcTknLCB7IGFjdGlvbjogcGFnZSB9KS50aGVuKGZ1bmN0aW9uICh0b2tlbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHZtLnJlQ2FwdGNoYSA9IHRva2VuO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKVxyXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKCkgeyBcclxuICAgICAgICAgICAgICAgICAgICBhbGVydCgnR29vZ2xl6amX6K2J5aSx5pWX77yM6KuL5YaN5qyh5ZiX6KmmXFxu5aaC54Sh5rOV5o6S6Zmk5q2k5ZWP6aGM77yM5bu66K2w6YeN5paw5pW055CG5q2k6aCB6Z2iJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KClcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9LCBcclxuICAgICAgICBnZXRJZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBnZXRFeHBsb3JlciA9IChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHZhciBleHBsb3JlciA9IHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50LFxyXG4gICAgICAgICAgICAgICAgY29tcGFyZSA9IGZ1bmN0aW9uKHMpIHsgcmV0dXJuIChleHBsb3Jlci5pbmRleE9mKHMpID49IDApOyB9LFxyXG4gICAgICAgICAgICAgICAgaWUxMSA9IChmdW5jdGlvbigpIHsgcmV0dXJuIChcIkFjdGl2ZVhPYmplY3RcIiBpbiB3aW5kb3cpIH0pKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoY29tcGFyZShcIk1TSUVcIikgfHwgaWUxMSkgeyByZXR1cm4gJ2llJzsgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoY29tcGFyZShcIkZpcmVmb3hcIikgJiYgIWllMTEpIHsgcmV0dXJuICdGaXJlZm94JzsgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoY29tcGFyZShcIkNocm9tZVwiKSAmJiAhaWUxMSkgeyByZXR1cm4gJ0Nocm9tZSc7IH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGNvbXBhcmUoXCJPcGVyYVwiKSAmJiAhaWUxMSkgeyByZXR1cm4gJ09wZXJhJzsgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoY29tcGFyZShcIlNhZmFyaVwiKSAmJiAhaWUxMSkgeyByZXR1cm4gJ1NhZmFyaSc7IH1cclxuICAgICAgICAgICAgfSkoKVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgKGdldEV4cGxvcmVyID09ICdpZScpIHtcclxuICAgICAgICAgICAgICAgIGFsZXJ0KCfnm67liY3ngI/opr3lmajngrroiIrniYggSUXvvIzlu7rorbDkvb/nlKhDaHJvbWXngI/opr3lmajvvIznjbLlvpfmnIDkvbPpgYrmiLLpq5TpqZfvvIEnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICB9LFxyXG4gICAgY29tcG9uZW50czoge1xyXG4gICAgICAgIGNvbWluZ3Nvb246IGNvbWluZ3Nvb25cclxuICAgIH0sXHJcbiAgICBtb3VudGVkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgIFxyXG4gICAgfVxyXG59KVxyXG5cclxuXHJcblZ1ZS5jb21wb25lbnQoJ2NvbWluZ3Nvb24nLCB7XHJcbiAgICB0ZW1wbGF0ZTogXCIjY29taW5nc29vblwiLFxyXG4gICAgcHJvcHM6IFsnU3RhcnREYXRlJywgJ21vZGUnXSxcclxuICAgIGRhdGE6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBjb21pbmdzb29uOiBmYWxzZSxcclxuICAgICAgICAgICAgY29tUGFnZTogXCJcIixcclxuICAgICAgICAgICAgc3RhcnRfZGF0ZTogXCJcIixcclxuICAgICAgICAgICAgbW9kZV9zdGF0dXM6IFwiXCIsXHJcbiAgICAgICAgICAgIGRhdGU6IHtcclxuICAgICAgICAgICAgICAgIHRvdGFsOiAwLFxyXG4gICAgICAgICAgICAgICAgZGF5czogMCxcclxuICAgICAgICAgICAgICAgIGhvdXJzOiAwLFxyXG4gICAgICAgICAgICAgICAgbWludXRlczogMCxcclxuICAgICAgICAgICAgICAgIHNlY29uZHM6IDBcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gICBcclxuICAgIH0sXHJcbiAgICBtb3VudGVkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHBhZExlZnQgPSBmdW5jdGlvbiAoc3RyLCBsZW4pIHtcclxuICAgICAgICAgICAgc3RyID0gJycgKyBzdHI7XHJcbiAgICAgICAgICAgIGlmIChzdHIubGVuZ3RoID49IGxlbikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHN0cjtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBwYWRMZWZ0KFwiMFwiICsgc3RyLCBsZW4pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgIC8vIHZtLnN0YXRlX2NoZWNrKCkudGhlbihmdW5jdGlvbiAocmVzKSB7XHJcbiAgICAgICAgLy8gICAgIHZhciBkYXRhID0gcmVzLkRhdGE7XHJcbiAgICAgICAgLy8gICAgIHZtLnN0YXJ0X2RhdGUgPSBkYXRhLlN0YXJ0RGF0ZVRpbWU7XHJcbiAgICAgICAgdm0uZ2V0VG9rZW4oKS50aGVuKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHZtLmdldHN0YXR1cygpLnRoZW4oZnVuY3Rpb24ocmVzKXtcclxuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwic3RhdHVzOlwiLHJlcyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgdmFyIHRpbWVpbnRlcnZhbCA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHQgPSBEYXRlLnBhcnNlKG5ldyBEYXRlKHZtLlN0YXJ0RGF0ZSkpIC0gRGF0ZS5wYXJzZShuZXcgRGF0ZSgpKTtcclxuICAgICAgICAgICAgdmFyIHNlY29uZHMgPSBNYXRoLmZsb29yKCh0IC8gMTAwMCkgJSA2MCk7XHJcbiAgICAgICAgICAgIHZhciBtaW51dGVzID0gTWF0aC5mbG9vcigodCAvIDEwMDAgLyA2MCkgJSA2MCk7XHJcbiAgICAgICAgICAgIHZhciBob3VycyA9IE1hdGguZmxvb3IoKHQgLyAoMTAwMCAqIDYwICogNjApKSAlIDI0KTtcclxuICAgICAgICAgICAgdmFyIGRheXMgPSBNYXRoLmZsb29yKHQgLyAoMTAwMCAqIDYwICogNjAgKiAyNCkpO1xyXG4gICAgICAgICAgICB2bS5kYXRlID0ge1xyXG4gICAgICAgICAgICAgICAgJ3RvdGFsJzogdCxcclxuICAgICAgICAgICAgICAgICdkYXlzJzogcGFkTGVmdChkYXlzLCAyKSxcclxuICAgICAgICAgICAgICAgICdob3Vycyc6IHBhZExlZnQoaG91cnMsIDIpLFxyXG4gICAgICAgICAgICAgICAgJ21pbnV0ZXMnOiBwYWRMZWZ0KG1pbnV0ZXMsIDIpLFxyXG4gICAgICAgICAgICAgICAgJ3NlY29uZHMnOiBwYWRMZWZ0KHNlY29uZHMsIDIpXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIC8vIGlmICh2bS5kYXRlLnRvdGFsIDw9IDAgfHwgdm0ubW9kZSA9PSBcIlRlc3RpbmdcIikge1xyXG4gICAgICAgICAgICAvLyAgICAgY2xlYXJJbnRlcnZhbCh0aW1laW50ZXJ2YWwpO1xyXG4gICAgICAgICAgICAvLyAgICAgdm0uY29taW5nc29vbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAvLyB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyAgICAgdm0uY29taW5nc29vbiA9IHRydWU7XHJcbiAgICAgICAgICAgIC8vIH1cclxuICAgICAgICB9LCAxMDAwKTtcclxuICAgICAgICAvLyB9KTtcclxuICAgIH0sXHJcbn0pXHJcbiJdfQ==
