"use strict";var result_view=new Vue({el:"#app",data:{step:2,code:"",name:"",friendName:"",address:"",mobile:"",text:"",textImg:"",serialNumber:"",agree:!1,link:"",savedata:!1,user:{shareImg:"",userImg1:"",userImg2:"",userImg3:""},keyWord:{word1:"",word2:"",word3:""}},methods:{getLocalStorage:function(){var t=this;t.user.shareImg=localStorage.getItem("shareImg"),t.toDataURL(localStorage.getItem("userImg1"),function(e){t.user.userImg1=e}),t.toDataURL(localStorage.getItem("userImg2"),function(e){t.user.userImg2=e}),t.toDataURL(localStorage.getItem("userImg3"),function(e){t.user.userImg3=e}),t.keyWord.word1=localStorage.getItem("keyword1"),t.keyWord.word2=localStorage.getItem("keyword2"),t.keyWord.word3=localStorage.getItem("keyword3"),$("body").loadpage("close")},getImg:function(){var t=this;return $.ajax({url:"".concat(friendo_url,"MineShine/image/").concat(t.code),headers:{Authorization:"Bearer "+t.gToken},method:"GET"}).done(function(e){t.serialNumber=e.data.serialNumber,t.user.shareImg=e.data.shareImg,t.toDataURL(e.data.userImg1,function(e){t.user.userImg1=e}),t.toDataURL(e.data.userImg2,function(e){t.user.userImg2=e}),t.toDataURL(e.data.userImg3,function(e){t.user.userImg3=e}),t.toDataURL(e.data.shareImg,function(e){t.user.shareImg=e}),t.keyWord.word1=e.data.keyword1,t.keyWord.word2=e.data.keyword2,t.keyWord.word3=e.data.keyword3,t.link=e.data.link,t.savedata=e.data.saveData,$("body").loadpage("close")})},saveData:function(){var t=this,e=new FormData;return e.append("code",t.code),e.append("name",t.name),e.append("friendName",t.friendName),e.append("address",t.address),e.append("mobile",t.mobile),e.append("textImg",t.textImg),e.append("serialNumber",t.serialNumber),e.append("reCaptcha",t.reCaptcha),$.ajax({url:"".concat(friendo_url,"MineShine/data"),headers:{Authorization:"Bearer "+t.gToken},data:e,method:"POST",processData:!1,contentType:!1}).done(function(e){e.success?(t.resultLoad=!1,t.popup=!0,t.popEvent="type",t.popPage="suc"):(alert("您已填過表單 感謝您的參與"),window.location.href="index.html")})},downloadImg:function(){var e=document.getElementById("dl1"),t=document.getElementById("dl2"),a=document.getElementById("dl3"),o=document.getElementById("dl4"),r=Date.now();e.setAttribute("download","img"+r),t.setAttribute("download","img"+r+1),a.setAttribute("download","img"+r+2),o.setAttribute("download","img"+r+3),setTimeout(function(){e.click(),t.click(),a.click(),o.click()},500)},giftput:function(){var t=this;if(!t.loading){if(""==t.name)return t.popup=!0,t.popEvent="type",void(t.popPage="dataerr");if(""==t.mobile||!t.mobile.match(/^09[0-9]{8}$/))return t.popup=!0,t.popEvent="type",void(t.popPage="dataerr");if(""==t.friendName)return t.popup=!0,t.popEvent="type",void(t.popPage="dataerr");if(""==t.text)return t.popup=!0,t.popEvent="type",void(t.popPage="dataerr");if(0==t.agree)return t.popup=!0,t.popEvent="type",void(t.popPage="dataerr");t.popup=!0,t.resultLoad=!0;var e=document.getElementById("giftbox"),a=e.getContext("2d");e.width=2835,e.height=2421,a.clearRect(0,0,e.width,e.height),a.font="50px Arial";var o=new Image,r=new Image,n=new Image,d=new Image,i=new Image,s=new Image,p=new Image,u=new Promise(function(e){o.addEventListener("load",function(){e()}),o.src="./images/giftboxbg.jpg"}),g=new Promise(function(e){r.addEventListener("load",function(){e()}),r.src=t.user.userImg1}),m=new Promise(function(e){n.addEventListener("load",function(){e()}),n.src=t.user.userImg2}),c=new Promise(function(e){d.addEventListener("load",function(){e()}),d.src=t.user.userImg3}),l=new Promise(function(e){i.addEventListener("load",function(){e()}),i.src=t.keyWord.word1}),h=new Promise(function(e){s.addEventListener("load",function(){e()}),s.src=t.keyWord.word2}),w=new Promise(function(e){p.addEventListener("load",function(){e()}),p.src=t.keyWord.word3});Promise.all([u,g,m,c,l,h,w]).then(function(){a.drawImage(o,0,0,o.width,o.height,0,0,e.width,e.height),a.drawImage(r,0,0,500,500,327,1433,505,486),a.drawImage(n,0,0,500,500,925,1505,505,486),a.drawImage(d,0,0,500,500,1498,1459,505,486),a.fillText(t.serialNumber,320,385),a.rotate(-9*Math.PI/180),a.drawImage(i,0,0,i.width,i.height,130,1200,.8*i.width,.8*i.height),a.font="bold 56px Noto Sans TC",a.fillStyle="#f2dc24",a.textAlign="start",a.fillText("To: "+t.friendName,1065,1e3),a.textAlign="center",a.fillText(t.text,1295,1080),a.rotate(9*Math.PI/180),a.rotate(-1*Math.PI/180),a.drawImage(s,0,0,s.width,s.height,900,1190,.8*s.width,.8*s.height),a.rotate(1*Math.PI/180),a.rotate(8*Math.PI/180),a.drawImage(p,0,0,p.width,p.height,1660,860,.8*p.width,.8*p.height),a.rotate(-8*Math.PI/180),t.textImg=e.toDataURL("image/jpeg",1),t.resultLoad=!1,t.popup=!0,t.popEvent="type",t.popPage="suc"})}},toFb:function(){var t=this;return new Promise(function(e){t.popup=!0,t.popEvent="type",t.popPage="tip",e()})},fbshare:function(){var e=this.link;window.ActiveXObject||window;return this.popupClose(),this.step=3,window.open("https://www.facebook.com/sharer/sharer.php?u="+e+"&hashtag=%23麥香曬友情"),!1},toDataURL:function(e,t){var a=new XMLHttpRequest;a.onload=function(){var e=new FileReader;e.onloadend=function(){t(e.result)},e.readAsDataURL(a.response)},a.open("GET",e),a.responseType="blob",a.send()},checkBrowser:function(){var e=this,t=new MobileDetect(window.navigator.userAgent),a=-1<navigator.userAgent.indexOf("FBAV");t.match(/android/i)?a?(e.popup=!0,e.popEvent="fbapp"):e.downloadImg():t.match(/(iphone|ipad|ipod);?/i)?(e.popup=!0,e.popEvent="type",e.popPage="ios"):e.downloadImg()}},created:function(){},mounted:function(){$("body").loadpage("init",{async:!0}),this.getLocalStorage()}});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlc3VsdC5qcyJdLCJuYW1lcyI6WyJyZXN1bHRfdmlldyIsIlZ1ZSIsImVsIiwic3RlcCIsImNvZGUiLCJuYW1lIiwiZnJpZW5kTmFtZSIsImFkZHJlc3MiLCJtb2JpbGUiLCJhZ3JlZSIsInRleHRJbWciLCJzZXJpYWxOdW1iZXIiLCJzaGFyZUltZyIsInVzZXJJbWcxIiwidXNlckltZzIiLCJ1c2VySW1nMyIsIndvcmQyIiwid29yZDMiLCJnZXRMb2NhbFN0b3JhZ2UiLCJ2bSIsInRoaXMiLCJ1c2VyIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsIlVybCIsInRvRGF0YVVSTCIsImtleVdvcmQiLCJsb2FkcGFnZSIsImdldEltZyIsIiQiLCJhamF4IiwidXJsIiwiY29uY2F0IiwiZnJpZW5kb191cmwiLCJoZWFkZXJzIiwiQXV0aG9yaXphdGlvbiIsImdUb2tlbiIsIm1ldGhvZCIsImRvbmUiLCJyZXMiLCJkYXRhIiwid29yZDEiLCJrZXl3b3JkMSIsImtleXdvcmQyIiwia2V5d29yZDMiLCJsaW5rIiwicG9zdF9kYXRhIiwiRm9ybURhdGEiLCJhcHBlbmQiLCJyZUNhcHRjaGEiLCJwcm9jZXNzRGF0YSIsInN1Y2Nlc3MiLCJyZXN1bHRMb2FkIiwicG9wdXAiLCJwb3BFdmVudCIsInBvcFBhZ2UiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImhyZWYiLCJkb3dubG9hZEltZyIsImRsMSIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJkbDIiLCJkbDMiLCJ0aW1lIiwiZGw0Iiwic2V0QXR0cmlidXRlIiwiY2xpY2siLCJnaWZ0cHV0IiwibG9hZGluZyIsIm1vYmlsZV9ydWxlIiwibWF0Y2giLCJ0ZXh0IiwiZ2lmdGNhbiIsImdjYyIsImdldENvbnRleHQiLCJ3aWR0aCIsImhlaWdodCIsImNsZWFyUmVjdCIsIkltYWdlIiwidXNlcmltZzEiLCJ1c2VyaW1nMiIsInByYmciLCJyZXNvbHZlIiwiZ2lmdEJnIiwiUHJvbWlzZSIsInByaW1nMSIsImFkZEV2ZW50TGlzdGVuZXIiLCJzcmMiLCJwcmltZzMiLCJ1c2VyaW1nMyIsInBya3cxIiwicHJrdzMiLCJwcmltZzIiLCJkcmF3SW1hZ2UiLCJwcmt3MiIsInRoZW4iLCJmaWxsVGV4dCIsImZpbGxTdHlsZSIsInJvdGF0ZSIsIk1hdGgiLCJQSSIsInRleHRBbGlnbiIsImZvbnQiLCJmYnNoYXJlIiwib3BlbiIsIkFjdGl2ZVhPYmplY3QiLCJwb3B1cENsb3NlIiwiZmJodG1sX3VybCIsInhociIsImNhbGxiYWNrIiwicmVhZGVyIiwiWE1MSHR0cFJlcXVlc3QiLCJvbmxvYWRlbmQiLCJyZXN1bHQiLCJGaWxlUmVhZGVyIiwicmVhZEFzRGF0YVVSTCIsInJlc3BvbnNlIiwicmVzcG9uc2VUeXBlIiwic2VuZCIsImNoZWNrQnJvd3NlciIsIm1kIiwiTW9iaWxlRGV0ZWN0IiwibmF2aWdhdG9yIiwidXNlckFnZW50IiwiaXNGYkFwcCIsImluZGV4T2YiLCJjcmVhdGVkIiwibW91bnRlZCIsImFzeW5jIl0sIm1hcHBpbmdzIjoiYUFBQSxJQUFJQSxZQUFjLElBQUlDLElBQUksQ0FDdEJDLEdBQUksT0FESkYsS0FBQUEsQ0FDSUcsS0FEa0IsRUFFaEJDLEtBQUEsR0FDRUMsS0FERixHQUNPQyxXQUFBLEdBQ0xDLFFBRkYsR0FHRUMsT0FIRixHQUlGRixLQUFVLEdBQ1ZDLFFBTEUsR0FNRkMsYUFORSxHQU9FQyxPQVBGLEVBUUZDLEtBQVMsR0FDVEMsVUFBYyxFQUNkRixLQUFPLENBVkxHLFNBQUEsR0FZTUMsU0FaTixHQWFJQyxTQUFBLEdBQ0ZGLFNBREUsSUFHRkUsUUFBVSxDQUNWQyxNQUFVLEdBakJaQyxNQUFBLEdBbUJLQyxNQUFFLEtBR0xBLFFBQU8sQ0FIRkMsZ0JBR0UsV0F4Qk8sSUFBQUMsRUFBQUMsS0EyQmJELEVBQUFFLEtBQUFULFNBQUFVLGFBQUFDLFFBQUEsWUFDTEwsRUFBQUEsVUFES0ksYUFBQUMsUUFBQSxZQUNhLFNBQUFDLEdBQ0xMLEVBQVRFLEtBQUFSLFNBQUFXLElBRUdDLEVBQUFBLFVB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dWx0LmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIHJlc3VsdF92aWV3ID0gbmV3IFZ1ZSh7XHJcbiAgICBlbDogXCIjYXBwXCIsXHJcbiAgICBkYXRhOiB7XHJcbiAgICAgICAgc3RlcDogMiwgLy8yLDNcclxuICAgICAgICBjb2RlOlwiXCIsXHJcbiAgICAgICAgbmFtZTogXCJcIixcclxuICAgICAgICBmcmllbmROYW1lOiBcIlwiLFxyXG4gICAgICAgIGFkZHJlc3M6IFwiXCIsXHJcbiAgICAgICAgbW9iaWxlOiBcIlwiLFxyXG4gICAgICAgIHRleHQ6IFwiXCIsXHJcbiAgICAgICAgdGV4dEltZzogXCJcIixcclxuICAgICAgICBzZXJpYWxOdW1iZXI6IFwiXCIsXHJcbiAgICAgICAgYWdyZWU6IGZhbHNlLFxyXG4gICAgICAgIGxpbms6IFwiXCIsXHJcbiAgICAgICAgc2F2ZWRhdGE6IGZhbHNlLFxyXG4gICAgICAgIHVzZXI6IHtcclxuICAgICAgICAgICAgc2hhcmVJbWc6IFwiXCIsXHJcbiAgICAgICAgICAgIHVzZXJJbWcxOiBcIlwiLFxyXG4gICAgICAgICAgICB1c2VySW1nMjogXCJcIixcclxuICAgICAgICAgICAgdXNlckltZzM6IFwiXCIsXHJcbiAgICAgICAgfSxcclxuICAgICAgICBrZXlXb3JkOiB7XHJcbiAgICAgICAgICAgIHdvcmQxOiBcIlwiLFxyXG4gICAgICAgICAgICB3b3JkMjogXCJcIixcclxuICAgICAgICAgICAgd29yZDM6IFwiXCJcclxuICAgICAgICB9LFxyXG4gICAgfSxcclxuICAgIG1ldGhvZHM6IHtcclxuICAgICAgICBnZXRMb2NhbFN0b3JhZ2UoKSB7XHJcbiAgICAgICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgICAgIHZtLnVzZXIuc2hhcmVJbWcgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnc2hhcmVJbWcnKTtcclxuICAgICAgICAgICAgdm0udG9EYXRhVVJMKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VySW1nMScpLGZ1bmN0aW9uKFVybCl7XHJcbiAgICAgICAgICAgICAgICB2bS51c2VyLnVzZXJJbWcxID0gVXJsO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdm0udG9EYXRhVVJMKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VySW1nMicpLGZ1bmN0aW9uKFVybCl7XHJcbiAgICAgICAgICAgICAgICB2bS51c2VyLnVzZXJJbWcyID0gVXJsO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdm0udG9EYXRhVVJMKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VySW1nMycpLGZ1bmN0aW9uKFVybCl7XHJcbiAgICAgICAgICAgICAgICB2bS51c2VyLnVzZXJJbWczID0gVXJsO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdm0ua2V5V29yZC53b3JkMSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdrZXl3b3JkMScpO1xyXG4gICAgICAgICAgICB2bS5rZXlXb3JkLndvcmQyID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2tleXdvcmQyJyk7XHJcbiAgICAgICAgICAgIHZtLmtleVdvcmQud29yZDMgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgna2V5d29yZDMnKTtcclxuICAgICAgICAgICAgJChcImJvZHlcIikubG9hZHBhZ2UoXCJjbG9zZVwiKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGdldEltZygpIHtcclxuICAgICAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICAgICAgcmV0dXJuICQuYWpheCh7XHJcbiAgICAgICAgICAgICAgICB1cmw6IGAke2ZyaWVuZG9fdXJsfU1pbmVTaGluZS9pbWFnZS8ke3ZtLmNvZGV9YCxcclxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICAgICAgICAgICBcIkF1dGhvcml6YXRpb25cIjogXCJCZWFyZXIgXCIrIHZtLmdUb2tlbixcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICAgICAgICAgIH0pLmRvbmUoZnVuY3Rpb24ocmVzKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhcImdldEltZzpcIixyZXMpO1xyXG4gICAgICAgICAgICAgICAgdm0uc2VyaWFsTnVtYmVyID0gcmVzLmRhdGEuc2VyaWFsTnVtYmVyO1xyXG4gICAgICAgICAgICAgICAgdm0udXNlci5zaGFyZUltZyA9IHJlcy5kYXRhLnNoYXJlSW1nO1xyXG4gICAgICAgICAgICAgICAgdm0udG9EYXRhVVJMKHJlcy5kYXRhLnVzZXJJbWcxLGZ1bmN0aW9uKFVybCl7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0udXNlci51c2VySW1nMSA9IFVybDtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdm0udG9EYXRhVVJMKHJlcy5kYXRhLnVzZXJJbWcyLGZ1bmN0aW9uKFVybCl7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0udXNlci51c2VySW1nMiA9IFVybDtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdm0udG9EYXRhVVJMKHJlcy5kYXRhLnVzZXJJbWczLGZ1bmN0aW9uKFVybCl7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0udXNlci51c2VySW1nMyA9IFVybDtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdm0udG9EYXRhVVJMKHJlcy5kYXRhLnNoYXJlSW1nLGZ1bmN0aW9uKFVybCl7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0udXNlci5zaGFyZUltZyA9IFVybDtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgLy8gdm0udXNlci51c2VySW1nMSA9IHJlcy5kYXRhLnVzZXJJbWcxO1xyXG4gICAgICAgICAgICAgICAgLy8gdm0udXNlci51c2VySW1nMiA9IHJlcy5kYXRhLnVzZXJJbWcyO1xyXG4gICAgICAgICAgICAgICAgLy8gdm0udXNlci51c2VySW1nMyA9IHJlcy5kYXRhLnVzZXJJbWczO1xyXG4gICAgICAgICAgICAgICAgdm0ua2V5V29yZC53b3JkMSA9IHJlcy5kYXRhLmtleXdvcmQxO1xyXG4gICAgICAgICAgICAgICAgdm0ua2V5V29yZC53b3JkMiA9IHJlcy5kYXRhLmtleXdvcmQyO1xyXG4gICAgICAgICAgICAgICAgdm0ua2V5V29yZC53b3JkMyA9IHJlcy5kYXRhLmtleXdvcmQzO1xyXG4gICAgICAgICAgICAgICAgdm0ubGluayA9IHJlcy5kYXRhLmxpbms7XHJcbiAgICAgICAgICAgICAgICB2bS5zYXZlZGF0YSA9IHJlcy5kYXRhLnNhdmVEYXRhO1xyXG4gICAgICAgICAgICAgICAgJChcImJvZHlcIikubG9hZHBhZ2UoXCJjbG9zZVwiKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzYXZlRGF0YSgpIHtcclxuICAgICAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICAgICAgdmFyIHBvc3RfZGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xyXG4gICAgICAgICAgICBwb3N0X2RhdGEuYXBwZW5kKFwiY29kZVwiLHZtLmNvZGUpO1xyXG4gICAgICAgICAgICBwb3N0X2RhdGEuYXBwZW5kKFwibmFtZVwiLHZtLm5hbWUpO1xyXG4gICAgICAgICAgICBwb3N0X2RhdGEuYXBwZW5kKFwiZnJpZW5kTmFtZVwiLHZtLmZyaWVuZE5hbWUpO1xyXG4gICAgICAgICAgICBwb3N0X2RhdGEuYXBwZW5kKFwiYWRkcmVzc1wiLHZtLmFkZHJlc3MpO1xyXG4gICAgICAgICAgICBwb3N0X2RhdGEuYXBwZW5kKFwibW9iaWxlXCIsdm0ubW9iaWxlKTtcclxuICAgICAgICAgICAgcG9zdF9kYXRhLmFwcGVuZChcInRleHRJbWdcIix2bS50ZXh0SW1nKTtcclxuICAgICAgICAgICAgcG9zdF9kYXRhLmFwcGVuZChcInNlcmlhbE51bWJlclwiLHZtLnNlcmlhbE51bWJlcik7XHJcbiAgICAgICAgICAgIHBvc3RfZGF0YS5hcHBlbmQoXCJyZUNhcHRjaGFcIix2bS5yZUNhcHRjaGEpO1xyXG4gICAgICAgICAgICByZXR1cm4gJC5hamF4KHtcclxuICAgICAgICAgICAgICAgIHVybDogYCR7ZnJpZW5kb191cmx9TWluZVNoaW5lL2RhdGFgLFxyXG4gICAgICAgICAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgICAgICAgICAgIFwiQXV0aG9yaXphdGlvblwiOiBcIkJlYXJlciBcIisgdm0uZ1Rva2VuLFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHBvc3RfZGF0YSxcclxuICAgICAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgICAgICAgICAgICBwcm9jZXNzRGF0YTogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICBjb250ZW50VHlwZTogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAvLyBkYXRhVHlwZTogXCJqc29uXCJcclxuICAgICAgICAgICAgfSkuZG9uZShmdW5jdGlvbihyZXMpIHtcclxuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwic2F2ZURhdGE6XCIscmVzKTtcclxuICAgICAgICAgICAgICAgIGlmKHJlcy5zdWNjZXNzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0ucmVzdWx0TG9hZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIHZtLnBvcHVwID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB2bS5wb3BFdmVudCA9IFwidHlwZVwiO1xyXG4gICAgICAgICAgICAgICAgICAgIHZtLnBvcFBhZ2UgPSBcInN1Y1wiO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBhbGVydChcIuaCqOW3suWhq+mBjuihqOWWriDmhJ/orJ3mgqjnmoTlj4PoiIdcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBcImluZGV4Lmh0bWxcIjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBkb3dubG9hZEltZygpIHtcclxuICAgICAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICAgICAgdmFyIGRsMSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZGwxXCIpO1xyXG4gICAgICAgICAgICB2YXIgZGwyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJkbDJcIik7XHJcbiAgICAgICAgICAgIHZhciBkbDMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImRsM1wiKTtcclxuICAgICAgICAgICAgdmFyIGRsNCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZGw0XCIpO1xyXG4gICAgICAgICAgICB2YXIgdGltZSA9IERhdGUubm93KCk7XHJcbiAgICAgICAgICAgIGRsMS5zZXRBdHRyaWJ1dGUoXCJkb3dubG9hZFwiLFwiaW1nXCIrdGltZSk7XHJcbiAgICAgICAgICAgIGRsMi5zZXRBdHRyaWJ1dGUoXCJkb3dubG9hZFwiLFwiaW1nXCIrdGltZSsxKTtcclxuICAgICAgICAgICAgZGwzLnNldEF0dHJpYnV0ZShcImRvd25sb2FkXCIsXCJpbWdcIit0aW1lKzIpO1xyXG4gICAgICAgICAgICBkbDQuc2V0QXR0cmlidXRlKFwiZG93bmxvYWRcIixcImltZ1wiK3RpbWUrMyk7XHJcblxyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgZGwxLmNsaWNrKCk7XHJcbiAgICAgICAgICAgICAgICBkbDIuY2xpY2soKTtcclxuICAgICAgICAgICAgICAgIGRsMy5jbGljaygpO1xyXG4gICAgICAgICAgICAgICAgZGw0LmNsaWNrKCk7XHJcbiAgICAgICAgICAgIH0sIDUwMCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBnaWZ0cHV0KCkge1xyXG4gICAgICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgICAgICAvL2NoZWNrIOihqOWWrlxyXG4gICAgICAgICAgICBpZighdm0ubG9hZGluZykge1xyXG4gICAgICAgICAgICAgICAgdmFyIG1vYmlsZV9ydWxlID0gL14wOVswLTldezh9JC87XHJcbiAgICAgICAgICAgICAgICB2YXIgY2hfcnVsZSA9IC9eW1xcdTRlMDAtXFx1OWZhNV17MSwxMH0kLzsgLy/pmZDlrprkuK3mlodcclxuICAgICAgICAgICAgICAgIGlmKHZtLm5hbWUgPT0gXCJcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHZtLnBvcHVwID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB2bS5wb3BFdmVudCA9IFwidHlwZVwiO1xyXG4gICAgICAgICAgICAgICAgICAgIHZtLnBvcFBhZ2UgPSBcImRhdGFlcnJcIjtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmKHZtLm1vYmlsZSA9PSBcIlwiIHx8ICF2bS5tb2JpbGUubWF0Y2gobW9iaWxlX3J1bGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0ucG9wdXAgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIHZtLnBvcEV2ZW50ID0gXCJ0eXBlXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0ucG9wUGFnZSA9IFwiZGF0YWVyclwiO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYodm0uZnJpZW5kTmFtZSA9PSBcIlwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0ucG9wdXAgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIHZtLnBvcEV2ZW50ID0gXCJ0eXBlXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0ucG9wUGFnZSA9IFwiZGF0YWVyclwiO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYodm0udGV4dCA9PSBcIlwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0ucG9wdXAgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIHZtLnBvcEV2ZW50ID0gXCJ0eXBlXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0ucG9wUGFnZSA9IFwiZGF0YWVyclwiO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYodm0uYWdyZWUgPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICB2bS5wb3B1cCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0ucG9wRXZlbnQgPSBcInR5cGVcIjtcclxuICAgICAgICAgICAgICAgICAgICB2bS5wb3BQYWdlID0gXCJkYXRhZXJyXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB2bS5wb3B1cCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAvLyB2bS5sb2FkaW5nID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHZtLnJlc3VsdExvYWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgLy8gJChcImJvZHlcIikubG9hZHBhZ2UoXCJpbml0XCIse2FzeW5jIDogdHJ1ZX0pO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vY2FudmFzIGdpZnRib3hcclxuICAgICAgICAgICAgICAgIHZhciBnaWZ0Y2FuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJnaWZ0Ym94XCIpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGdjYyA9IGdpZnRjYW4uZ2V0Q29udGV4dCgnMmQnKTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgZ2lmdGNhbi53aWR0aCA9IDI4MzU7XHJcbiAgICAgICAgICAgICAgICBnaWZ0Y2FuLmhlaWdodCA9IDI0MjE7XHJcbiAgICAgICAgICAgICAgICAvLyBnaWZ0Y2FuLndpZHRoID0gODM1O1xyXG4gICAgICAgICAgICAgICAgLy8gZ2lmdGNhbi5oZWlnaHQgPSA0MjE7XHJcbiAgICAgICAgICAgICAgICBnY2MuY2xlYXJSZWN0KDAsMCxnaWZ0Y2FuLndpZHRoLGdpZnRjYW4uaGVpZ2h0KTtcclxuICAgICAgICAgICAgICAgIGdjYy5mb250ID0gXCI1MHB4IEFyaWFsXCI7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGdpZnRCZyA9IG5ldyBJbWFnZSgpO1xyXG4gICAgICAgICAgICAgICAgdmFyIHVzZXJpbWcxID0gbmV3IEltYWdlKCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgdXNlcmltZzIgPSBuZXcgSW1hZ2UoKTtcclxuICAgICAgICAgICAgICAgIHZhciB1c2VyaW1nMyA9IG5ldyBJbWFnZSgpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGtleXdvcmQxID0gbmV3IEltYWdlKCk7XHJcbiAgICAgICAgICAgICAgICB2YXIga2V5d29yZDIgPSBuZXcgSW1hZ2UoKTtcclxuICAgICAgICAgICAgICAgIHZhciBrZXl3b3JkMyA9IG5ldyBJbWFnZSgpO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBwcmJnID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSl7XHJcbiAgICAgICAgICAgICAgICAgICAgZ2lmdEJnLmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsIGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBnaWZ0Qmcuc3JjPVwiLi9pbWFnZXMvZ2lmdGJveGJnLmpwZ1wiO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIHByaW1nMSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUpe1xyXG4gICAgICAgICAgICAgICAgICAgIHVzZXJpbWcxLmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsIGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB1c2VyaW1nMS5zcmM9IHZtLnVzZXIudXNlckltZzE7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgcHJpbWcyID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSl7XHJcbiAgICAgICAgICAgICAgICAgICAgdXNlcmltZzIuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIiwgZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHVzZXJpbWcyLnNyYz0gdm0udXNlci51c2VySW1nMjtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBwcmltZzMgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKXtcclxuICAgICAgICAgICAgICAgICAgICB1c2VyaW1nMy5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLCBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdXNlcmltZzMuc3JjPSB2bS51c2VyLnVzZXJJbWczXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgcHJrdzEgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKXtcclxuICAgICAgICAgICAgICAgICAgICBrZXl3b3JkMS5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLCBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAga2V5d29yZDEuc3JjPSB2bS5rZXlXb3JkLndvcmQxO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIHBya3cyID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSl7XHJcbiAgICAgICAgICAgICAgICAgICAga2V5d29yZDIuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIiwgZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGtleXdvcmQyLnNyYz0gdm0ua2V5V29yZC53b3JkMjtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBwcmt3MyA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUpe1xyXG4gICAgICAgICAgICAgICAgICAgIGtleXdvcmQzLmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsIGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBrZXl3b3JkMy5zcmM9IHZtLmtleVdvcmQud29yZDM7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBQcm9taXNlLmFsbChbcHJiZyxwcmltZzEscHJpbWcyLHByaW1nMyxwcmt3MSxwcmt3Mixwcmt3M10pLnRoZW4oZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgICAgICBnY2MuZHJhd0ltYWdlKGdpZnRCZywwLDAsZ2lmdEJnLndpZHRoLGdpZnRCZy5oZWlnaHQsMCwwLGdpZnRjYW4ud2lkdGgsZ2lmdGNhbi5oZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGdjYy5kcmF3SW1hZ2UodXNlcmltZzEsMCwwLDUwMCw1MDAsMzI3LDE0MzMsNTA1LDQ4Nik7XHJcbiAgICAgICAgICAgICAgICAgICAgZ2NjLmRyYXdJbWFnZSh1c2VyaW1nMiwwLDAsNTAwLDUwMCw5MjUsMTUwNSw1MDUsNDg2KTtcclxuICAgICAgICAgICAgICAgICAgICBnY2MuZHJhd0ltYWdlKHVzZXJpbWczLDAsMCw1MDAsNTAwLDE0OTgsMTQ1OSw1MDUsNDg2KTtcclxuICAgICAgICAgICAgICAgICAgICBnY2MuZmlsbFRleHQodm0uc2VyaWFsTnVtYmVyLDMyMCwzODUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGdjYy5yb3RhdGUoLTkgKiBNYXRoLlBJIC8gMTgwKTtcclxuICAgICAgICAgICAgICAgICAgICBnY2MuZHJhd0ltYWdlKGtleXdvcmQxLDAsMCxrZXl3b3JkMS53aWR0aCxrZXl3b3JkMS5oZWlnaHQsMTMwLDEyMDAsa2V5d29yZDEud2lkdGgqMC44LGtleXdvcmQxLmhlaWdodCowLjgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGdjYy5mb250ID0gXCJib2xkIDU2cHggTm90byBTYW5zIFRDXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgZ2NjLmZpbGxTdHlsZSA9IFwiI2YyZGMyNFwiO1xyXG4gICAgICAgICAgICAgICAgICAgIGdjYy50ZXh0QWxpZ24gPSBcInN0YXJ0XCJcclxuICAgICAgICAgICAgICAgICAgICBnY2MuZmlsbFRleHQoXCJUbzogXCIrIHZtLmZyaWVuZE5hbWUsMTA2NSwxMDAwKTtcclxuICAgICAgICAgICAgICAgICAgICBnY2MudGV4dEFsaWduID0gXCJjZW50ZXJcIlxyXG4gICAgICAgICAgICAgICAgICAgIGdjYy5maWxsVGV4dCh2bS50ZXh0LDEyOTUsMTA4MCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZ2NjLnJvdGF0ZSg5ICogTWF0aC5QSSAvIDE4MCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZ2NjLnJvdGF0ZSgtMSAqIE1hdGguUEkgLyAxODApO1xyXG4gICAgICAgICAgICAgICAgICAgIGdjYy5kcmF3SW1hZ2Uoa2V5d29yZDIsMCwwLGtleXdvcmQyLndpZHRoLGtleXdvcmQyLmhlaWdodCw5MDAsMTE5MCxrZXl3b3JkMi53aWR0aCowLjgsa2V5d29yZDIuaGVpZ2h0KjAuOCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZ2NjLnJvdGF0ZSgxICogTWF0aC5QSSAvIDE4MCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZ2NjLnJvdGF0ZSg4ICogTWF0aC5QSSAvIDE4MCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZ2NjLmRyYXdJbWFnZShrZXl3b3JkMywwLDAsa2V5d29yZDMud2lkdGgsa2V5d29yZDMuaGVpZ2h0LDE2NjAsODYwLGtleXdvcmQzLndpZHRoKjAuOCxrZXl3b3JkMy5oZWlnaHQqMC44KTtcclxuICAgICAgICAgICAgICAgICAgICBnY2Mucm90YXRlKC04ICogTWF0aC5QSSAvIDE4MCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0udGV4dEltZyA9IGdpZnRjYW4udG9EYXRhVVJMKFwiaW1hZ2UvanBlZ1wiLCAxKTtcclxuICAgICAgICAgICAgICAgICAgICB2bS5yZXN1bHRMb2FkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0ucG9wdXAgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIHZtLnBvcEV2ZW50ID0gXCJ0eXBlXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0ucG9wUGFnZSA9IFwic3VjXCI7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICBcclxuICAgICAgICB9LFxyXG4gICAgICAgIHRvRmIoKSB7XHJcbiAgICAgICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKXtcclxuICAgICAgICAgICAgICAgIHZtLnBvcHVwID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHZtLnBvcEV2ZW50ID0gXCJ0eXBlXCI7XHJcbiAgICAgICAgICAgICAgICB2bS5wb3BQYWdlID0gXCJ0aXBcIjtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9LFxyXG4gICAgICAgIGZic2hhcmUoKSB7XHJcbiAgICAgICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgICAgIHZhciBmYmh0bWxfdXJsPSB2bS5saW5rO1xyXG4gICAgICAgICAgICB2YXIgaXNJRT13aW5kb3cuQWN0aXZlWE9iamVjdCB8fCBcIkFjdGl2ZVhPYmplY3RcIiBpbiB3aW5kb3c7XHJcbiAgICAgICAgICAgIHZtLnBvcHVwQ2xvc2UoKTtcclxuICAgICAgICAgICAgdm0uc3RlcCA9IDM7XHJcbiAgICAgICAgICAgIHdpbmRvdy5vcGVuKCdodHRwczovL3d3dy5mYWNlYm9vay5jb20vc2hhcmVyL3NoYXJlci5waHA/dT0nK2ZiaHRtbF91cmwrJyZoYXNodGFnPSUyM+m6pemmmeabrOWPi+aDhScpO3JldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgLy8gaWYoaXNJRSkge1xyXG4gICAgICAgICAgICAvLyAgICAgd2luZG93Lm9wZW4oJ2h0dHBzOi8vd3d3LmZhY2Vib29rLmNvbS9zaGFyZXIvc2hhcmVyLnBocD91PScrZmJodG1sX3VybCk7cmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAvLyB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyAgICAgd2luZG93Lm9wZW4oJ2h0dHBzOi8vd3d3LmZhY2Vib29rLmNvbS9zaGFyZXIvc2hhcmVyLnBocD91PScrZmJodG1sX3VybCsnJmhhc2h0YWc9JTIz6bql6aaZ5pus5Y+L5oOFJyk7cmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICB0b0RhdGFVUkwodXJsLCBjYWxsYmFjaykge1xyXG4gICAgICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgICAgICB2YXIgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XHJcbiAgICAgICAgICAgIHhoci5vbmxvYWQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xyXG4gICAgICAgICAgICAgICAgcmVhZGVyLm9ubG9hZGVuZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKHJlYWRlci5yZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoeGhyLnJlc3BvbnNlKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgeGhyLm9wZW4oJ0dFVCcsIHVybCk7XHJcbiAgICAgICAgICAgIHhoci5yZXNwb25zZVR5cGUgPSAnYmxvYic7XHJcbiAgICAgICAgICAgIHhoci5zZW5kKCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBjaGVja0Jyb3dzZXIoKSB7XHJcbiAgICAgICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgICAgIHZhciBkZXZpY2UgPSB7fTtcclxuICAgICAgICAgICAgdmFyIG1kID0gbmV3IE1vYmlsZURldGVjdCh3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudCk7XHJcbiAgICAgICAgICAgIHZhciB1ID0gbmF2aWdhdG9yLnVzZXJBZ2VudDtcclxuICAgICAgICAgICAgdmFyIGlzRmJBcHAgPSB1LmluZGV4T2YoXCJGQkFWXCIpID4gLTE7IC8vIEZCIEFwcCDlhaflu7rngI/opr3lmahcclxuICAgICAgICAgICAgaWYobWQubWF0Y2goL2FuZHJvaWQvaSkpIHtcclxuICAgICAgICAgICAgICAgIGlmKGlzRmJBcHApIHtcclxuICAgICAgICAgICAgICAgICAgICB2bS5wb3B1cCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0ucG9wRXZlbnQgPSBcImZiYXBwXCI7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHZtLmRvd25sb2FkSW1nKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZihtZC5tYXRjaCgvKGlwaG9uZXxpcGFkfGlwb2QpOz8vaSkpIHtcclxuICAgICAgICAgICAgICAgIHZtLnBvcHVwID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHZtLnBvcEV2ZW50ID0gXCJ0eXBlXCI7XHJcbiAgICAgICAgICAgICAgICB2bS5wb3BQYWdlID0gXCJpb3NcIjtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHZtLmRvd25sb2FkSW1nKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgY3JlYXRlZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICAvLyB2bS5jb2RlID0gZmluZEdldFBhcmFtZXRlcihcInVzZXJcIik7XHJcbiAgICB9LFxyXG4gICAgbW91bnRlZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICAkKFwiYm9keVwiKS5sb2FkcGFnZShcImluaXRcIix7YXN5bmMgOiB0cnVlfSk7XHJcbiAgICAgICAgdm0uZ2V0TG9jYWxTdG9yYWdlKCk7XHJcbiAgICAgICAgLy8gdm0uZ2V0VG9rZW4oKS50aGVuKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgLy8gICAgIHZtLmdldEltZygpO1xyXG4gICAgICAgIC8vIH0pXHJcbiAgICAgICAgLy8gdm0uY2hlY2tCcm93c2VyKCk7XHJcbiAgICB9XHJcbn0pIl19
